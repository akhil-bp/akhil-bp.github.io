function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var i=[],a=!0,o=!1,n=void 0;try{for(var c,r=t[Symbol.iterator]();!(a=(c=r.next()).done)&&(i.push(c.value),!e||i.length!==e);a=!0);}catch(s){o=!0,n=s}finally{try{a||null==r.return||r.return()}finally{if(o)throw n}}return i}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,a=new Array(e);i<e;i++)a[i]=t[i];return a}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"6dU7":function(t,e,i){"use strict";i.r(e);var a=i("ofXK"),o=i("tyNb"),n=i("3Pt+"),c=i("0IaG"),r=i("fXoL"),s=i("kmnG"),l=i("qFsG"),u=i("bTqV"),p=i("0Lhs");function h(t,e){1&t&&(r.bc(0,"p",12),r.Pc(1,"*Please fill all the fields"),r.ac())}var d,m,f=((d=function(){function t(e,i,a){_classCallCheck(this,t),this.data=e,this.dialogRef=i,this.fb=a}return _createClass(t,[{key:"ngOnInit",value:function(){this.buildItemForm(this.data.payload)}},{key:"buildItemForm",value:function(t){this.itemForm=this.fb.group({name:[t.name||"",n.t.required],code:[t.code||"",n.t.required]})}},{key:"submit",value:function(){this.itemForm.value.name=this.itemForm.value.name.trim(),this.itemForm.value.code=this.itemForm.value.code.trim(),this.itemForm.value.code.length>0&&this.itemForm.value.name.length>0?this.dialogRef.close(this.itemForm.value):this.validationErrors=!0}}]),t}()).\u0275fac=function(t){return new(t||d)(r.Vb(c.a),r.Vb(c.f),r.Vb(n.c))},d.\u0275cmp=r.Pb({type:d,selectors:[["app-state-popup"]],decls:18,vars:7,consts:[["matDialogTitle",""],[3,"formGroup","ngSubmit"],["fxLayout","row wrap","fxLayout.lt-sm","column"],["fxFlex","50",1,"pr-1"],[1,"full-width","p-b-10"],["matInput","","name","username","formControlName","name","placeholder","State"],["matInput","","name","username","formControlName","code","placeholder","State Code"],["class","error-msg",4,"ngIf"],["fxFlex","100",1,"mt-1"],["mat-raised-button","","color","primary",3,"disabled"],["fxFlex",""],["mat-button","","color","warn","type","button",3,"click"],[1,"error-msg"]],template:function(t,e){1&t&&(r.bc(0,"h1",0),r.Pc(1),r.ac(),r.bc(2,"form",1),r.jc("ngSubmit",(function(t){return e.submit()})),r.bc(3,"div",2),r.bc(4,"div",3),r.bc(5,"mat-form-field",4),r.Wb(6,"input",5),r.ac(),r.ac(),r.bc(7,"div",3),r.bc(8,"mat-form-field",4),r.Wb(9,"input",6),r.ac(),r.ac(),r.Nc(10,h,2,0,"p",7),r.bc(11,"div",8),r.bc(12,"button",9),r.Pc(13),r.oc(14,"translate"),r.ac(),r.Wb(15,"span",10),r.bc(16,"button",11),r.jc("click",(function(t){return e.dialogRef.close(!1)})),r.Pc(17,"Cancel"),r.ac(),r.ac(),r.ac(),r.ac()),2&t&&(r.Gb(1),r.Qc(e.data.title),r.Gb(1),r.sc("formGroup",e.itemForm),r.Gb(8),r.sc("ngIf",e.validationErrors),r.Gb(2),r.sc("disabled",e.itemForm.invalid),r.Gb(1),r.Qc(r.pc(14,5,"SAVE")))},directives:[c.g,n.u,n.o,n.h,s.b,l.b,n.b,n.n,n.f,a.l,u.b],pipes:[p.c],styles:[".p-b-10[_ngcontent-%COMP%]{padding-bottom:10px}.error-msg[_ngcontent-%COMP%]{color:red}"]}),d),g=i("3sEA"),b=i("z6cu"),v=i("AytR"),y=i("tk/3"),x=((m=function(){function t(e){_classCallCheck(this,t),this.http=e,this.apiUrl=v.a.apiURL}return _createClass(t,[{key:"getStates",value:function(){return this.http.get(this.apiUrl+"location/state/list")}},{key:"getstate",value:function(t){return this.http.get(this.apiUrl+"location/state/details/"+t)}},{key:"deleteState",value:function(t){return this.http.get(this.apiUrl+"location/state/delete/"+t)}},{key:"addState",value:function(t){return this.http.post(this.apiUrl+"location/state/add",t)}},{key:"updateState",value:function(t,e){return this.http.post(this.apiUrl+"location/state/update/"+t,e)}},{key:"getDistricts",value:function(){return this.http.get(this.apiUrl+"location/district/list")}},{key:"deleteDistrict",value:function(t){return this.http.get(this.apiUrl+"location/district/delete/"+t)}},{key:"addDistrict",value:function(t){return this.http.post(this.apiUrl+"location/district/add",t)}},{key:"updateDistrict",value:function(t,e){return this.http.post(this.apiUrl+"location/district/update/"+t,e)}},{key:"getDistrict",value:function(t){return this.http.get(this.apiUrl+"location/district/details/"+t)}},{key:"getRegions",value:function(){return this.http.get(this.apiUrl+"location/region/list")}},{key:"deleteRegion",value:function(t){return this.http.get(this.apiUrl+"location/region/delete/"+t)}},{key:"addRegion",value:function(t){return this.http.post(this.apiUrl+"location/region/add",t)}},{key:"updateRegion",value:function(t,e){return this.http.post(this.apiUrl+"location/region/update/"+t,e)}},{key:"getRegion",value:function(t){return this.http.get(this.apiUrl+"location/region/details/"+t)}},{key:"errorHandler",value:function(t){var e;return e=t.error instanceof ErrorEvent?t.error.message:"Error Code: ".concat(t.status,"\nMessage: ").concat(t.message),Object(b.a)(e)}}]),t}()).\u0275fac=function(t){return new(t||m)(r.fc(y.c))},m.\u0275prov=r.Rb({token:m,factory:m.\u0275fac,providedIn:"root"}),m),C=i("3kSh"),k=i("quSY"),w=i("dNgK"),S=i("Wp6s"),A=i("lDzL"),_=i("1jcm"),P=i("NFeN");function I(t,e){if(1&t&&r.Pc(0),2&t){var i=e.row;r.Rc(" ",null==i?null:i.name," ")}}function M(t,e){if(1&t&&r.Pc(0),2&t){var i=e.row;r.Rc(" ",null==i?null:i.code," ")}}function O(t,e){if(1&t){var i=r.cc();r.bc(0,"mat-slide-toggle",9),r.jc("change",(function(t){r.Gc(i);var a=e.row;return r.nc().statusChange(a,t)})),r.ac()}if(2&t){var a=e.row;r.sc("checked","active"===(null==a?null:a.status))}}function G(t,e){if(1&t){var i=r.cc();r.bc(0,"button",10),r.jc("click",(function(t){r.Gc(i);var a=e.row;return r.nc().openPopUp(a)})),r.bc(1,"mat-icon"),r.Pc(2,"edit"),r.ac(),r.ac(),r.bc(3,"button",11),r.jc("click",(function(t){r.Gc(i);var a=e.row;return r.nc().deleteItem(a)})),r.bc(4,"mat-icon"),r.Pc(5,"delete"),r.ac(),r.ac()}}var R,F=((R=function(){function t(e,i,a,o,n){_classCallCheck(this,t),this.dialog=e,this.snack=i,this.locationApiService=a,this.confirmServive=o,this.loader=n,this.states=[],this.statesArray=[],this.subscripition=new k.a}return _createClass(t,[{key:"ngOnInit",value:function(){this.loader.open(),this.getStates()}},{key:"getStates",value:function(){var t=this;this.subscripition.add(this.locationApiService.getStates().subscribe((function(e){t.states=_toConsumableArray(e.result),t.loader.close()}),(function(e){t.loader.close()})))}},{key:"openPopUp",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;this.dialog.open(f,{width:"520px",disableClose:!0,data:{title:i?"Add New State":"Update state",payload:e}}).afterClosed().subscribe((function(a){a&&(t.loader.open(),t.subscripition.add(i?t.locationApiService.addState(a).subscribe((function(e){t.loader.close(),"success"===e.status&&(t.states.push(e.result),t.states=_toConsumableArray(t.states),t.snack.open("State Added!","OK",{duration:4e3}))}),(function(e){t.loader.close()})):t.locationApiService.updateState(e._id,a).subscribe((function(i){t.loader.close(),"success"===i.status&&(t.getState(e._id,"update"),t.snack.open("State Updated!","OK",{duration:4e3}))}),(function(e){t.loader.close()}))))}))}},{key:"getState",value:function(t,e){var i=this;this.subscripition.add(this.locationApiService.getstate(t).subscribe((function(t){"update"===e&&i.states.forEach((function(e,a){e._id===t.result._id&&(i.states[a]=t.result,i.states=_toConsumableArray(i.states))}))}),(function(t){i.loader.close()})))}},{key:"deleteItem",value:function(t){var e=this;this.subscripition.add(this.confirmServive.confirm({message:"Delete ".concat(t.name,"?")}).subscribe((function(i){i&&(e.loader.open(),e.states.forEach((function(i,a){i._id===t._id&&e.states.splice(a,1)})),e.states=_toConsumableArray(e.states),e.locationApiService.deleteState(t._id).subscribe((function(t){e.loader.close(),"success"===t.status&&e.snack.open("State deleted!","OK",{duration:4e3})}),(function(t){e.loader.close()})))})))}},{key:"statusChange",value:function(t,e){var i=this;this.loader.open(),this.subscripition.add(this.locationApiService.updateState(t._id,{status:e.checked?"active":"inactive"}).subscribe((function(e){i.loader.close(),"success"===e.status&&(i.getState(t._id,"update"),i.snack.open("Status Updated!","OK",{duration:4e3}))}),(function(t){i.loader.close()})))}},{key:"ngOnDestroy",value:function(){this.subscripition.unsubscribe()}}]),t}()).\u0275fac=function(t){return new(t||R)(r.Vb(c.b),r.Vb(w.a),r.Vb(x),r.Vb(C.a),r.Vb(g.a))},R.\u0275cmp=r.Pb({type:R,selectors:[["app-state"]],decls:16,vars:16,consts:[[1,"m-333"],["mat-raised-button","","color","primary",1,"mb-05",3,"click"],[1,"p-0"],[1,"material","ml-0","mr-0",3,"rows","columnMode","headerHeight","footerHeight","limit","rowHeight"],["name","State",3,"flexGrow"],["ngx-datatable-cell-template",""],["name","State Code",3,"flexGrow"],["name","Active",3,"flexGrow"],["name","Actions",3,"flexGrow"],[3,"checked","change"],["mat-icon-button","","mat-sm-button","","color","primary",1,"mr-1",3,"click"],["mat-icon-button","","mat-sm-button","","color","warn",3,"click"]],template:function(t,e){1&t&&(r.bc(0,"div",0),r.bc(1,"button",1),r.jc("click",(function(t){return e.openPopUp({},!0)})),r.Pc(2),r.oc(3,"translate"),r.oc(4,"translate"),r.ac(),r.ac(),r.bc(5,"mat-card",2),r.bc(6,"mat-card-content",2),r.bc(7,"ngx-datatable",3),r.bc(8,"ngx-datatable-column",4),r.Nc(9,I,1,1,"ng-template",5),r.ac(),r.bc(10,"ngx-datatable-column",6),r.Nc(11,M,1,1,"ng-template",5),r.ac(),r.bc(12,"ngx-datatable-column",7),r.Nc(13,O,1,1,"ng-template",5),r.ac(),r.bc(14,"ngx-datatable-column",8),r.Nc(15,G,6,0,"ng-template",5),r.ac(),r.ac(),r.ac(),r.ac()),2&t&&(r.Gb(2),r.Sc("",r.pc(3,12,"ADD")," ",r.pc(4,14,"State"),""),r.Gb(5),r.sc("rows",e.states)("columnMode","force")("headerHeight",50)("footerHeight",50)("limit",10)("rowHeight",50),r.Gb(1),r.sc("flexGrow",1),r.Gb(2),r.sc("flexGrow",1),r.Gb(2),r.sc("flexGrow",1),r.Gb(2),r.sc("flexGrow",1))},directives:[u.b,S.a,S.b,A.d,A.b,A.a,_.a,P.a],pipes:[p.c],styles:[""]}),R),z=i("d3UM"),E=i("FKr1");function U(t,e){if(1&t&&(r.bc(0,"mat-option",14),r.Pc(1),r.ac()),2&t){var i=e.$implicit;r.sc("value",i._id),r.Gb(1),r.Qc(i.name)}}function D(t,e){1&t&&(r.bc(0,"p",15),r.Pc(1,"*Please fill all the fields"),r.ac())}var T,V=((T=function(){function t(e,i,a,o,n){_classCallCheck(this,t),this.data=e,this.locationApiService=i,this.dialogRef=a,this.fb=o,this.loader=n,this.subscripition=new k.a,this.states=[]}return _createClass(t,[{key:"ngOnInit",value:function(){this.loader.open(),this.getStates(),this.buildItemForm(this.data.payload)}},{key:"getStates",value:function(){var t=this;this.subscripition.add(this.locationApiService.getStates().subscribe((function(e){t.states=e.result,t.loader.close()}),(function(e){t.loader.close()})))}},{key:"buildItemForm",value:function(t){var e,i;this.itemForm=this.fb.group({state:[(null===(i=null===(e=t)||void 0===e?void 0:e.state)||void 0===i?void 0:i._id)||null,n.t.required],name:[t.name||null,n.t.required],code:[t.code||null,n.t.required]})}},{key:"submit",value:function(){this.itemForm.value.name=this.itemForm.value.name.trim(),this.itemForm.value.code=this.itemForm.value.code.trim(),this.itemForm.value.code.length>0&&this.itemForm.value.name.length>0?this.dialogRef.close(this.itemForm.value):this.validationErrors=!0}},{key:"ngOnDestroy",value:function(){this.loader.close(),this.subscripition.unsubscribe()}}]),t}()).\u0275fac=function(t){return new(t||T)(r.Vb(c.a),r.Vb(x),r.Vb(c.f),r.Vb(n.c),r.Vb(g.a))},T.\u0275cmp=r.Pb({type:T,selectors:[["app-district-popup"]],decls:22,vars:8,consts:[["matDialogTitle",""],[3,"formGroup","ngSubmit"],["fxLayout","row wrap","fxLayout.lt-sm","column"],["fxFlex","50",1,"pr-1"],[1,"full-width","p-b-10"],["placeholder","Select State","name","state","formControlName","state",1,"full-width","state-box"],["ngDefaultControl","",3,"value",4,"ngFor","ngForOf"],["matInput","","name","username","formControlName","name","placeholder","District"],["matInput","","name","username","formControlName","code","placeholder","District Code"],["class","error-msg",4,"ngIf"],["fxFlex","100",1,"mt-1"],["mat-raised-button","","color","primary",3,"disabled"],["fxFlex",""],["mat-button","","color","warn","type","button",3,"click"],["ngDefaultControl","",3,"value"],[1,"error-msg"]],template:function(t,e){1&t&&(r.bc(0,"h1",0),r.Pc(1),r.ac(),r.bc(2,"form",1),r.jc("ngSubmit",(function(t){return e.submit()})),r.bc(3,"div",2),r.bc(4,"div",3),r.bc(5,"mat-form-field",4),r.bc(6,"mat-select",5),r.Nc(7,U,2,2,"mat-option",6),r.ac(),r.ac(),r.ac(),r.bc(8,"div",3),r.bc(9,"mat-form-field",4),r.Wb(10,"input",7),r.ac(),r.ac(),r.bc(11,"div",3),r.bc(12,"mat-form-field",4),r.Wb(13,"input",8),r.ac(),r.ac(),r.Nc(14,D,2,0,"p",9),r.bc(15,"div",10),r.bc(16,"button",11),r.Pc(17),r.oc(18,"translate"),r.ac(),r.Wb(19,"span",12),r.bc(20,"button",13),r.jc("click",(function(t){return e.dialogRef.close(!1)})),r.Pc(21,"Cancel"),r.ac(),r.ac(),r.ac(),r.ac()),2&t&&(r.Gb(1),r.Qc(e.data.title),r.Gb(1),r.sc("formGroup",e.itemForm),r.Gb(5),r.sc("ngForOf",e.states),r.Gb(7),r.sc("ngIf",e.validationErrors),r.Gb(2),r.sc("disabled",e.itemForm.invalid),r.Gb(1),r.Qc(r.pc(18,6,"SAVE")))},directives:[c.g,n.u,n.o,n.h,s.b,z.a,n.n,n.f,a.k,l.b,n.b,a.l,u.b,E.p],pipes:[p.c],styles:[".state-box[_ngcontent-%COMP%]{width:120px}.p-b-10[_ngcontent-%COMP%]{padding-bottom:10px}.error-msg[_ngcontent-%COMP%]{color:red}"]}),T);function j(t,e){if(1&t&&r.Pc(0),2&t){var i=e.row;r.Rc(" ",null==i?null:i.name," ")}}function W(t,e){if(1&t&&r.Pc(0),2&t){var i=e.row;r.Rc(" ",null==i?null:i.code," ")}}function H(t,e){if(1&t&&r.Pc(0),2&t){var i=e.row;r.Rc(" ",null==i?null:i.state.name," ")}}function N(t,e){if(1&t){var i=r.cc();r.bc(0,"mat-slide-toggle",10),r.jc("change",(function(t){r.Gc(i);var a=e.row;return r.nc().statusChange(a,t)})),r.ac()}if(2&t){var a=e.row;r.sc("checked","active"===(null==a?null:a.status))}}function L(t,e){if(1&t){var i=r.cc();r.bc(0,"button",11),r.jc("click",(function(t){r.Gc(i);var a=e.row;return r.nc().openPopUp(a)})),r.bc(1,"mat-icon"),r.Pc(2,"edit"),r.ac(),r.ac(),r.bc(3,"button",12),r.jc("click",(function(t){r.Gc(i);var a=e.row;return r.nc().deleteItem(a)})),r.bc(4,"mat-icon"),r.Pc(5,"delete"),r.ac(),r.ac()}}var B,Q=((B=function(){function t(e,i,a,o,n){_classCallCheck(this,t),this.dialog=e,this.snack=i,this.locationApiService=a,this.loader=o,this.confirmService=n,this.districts=[],this.subscripition=new k.a}return _createClass(t,[{key:"ngOnInit",value:function(){this.loader.open(),this.getStates()}},{key:"getStates",value:function(){var t=this;this.subscripition.add(this.locationApiService.getDistricts().subscribe((function(e){t.districts=_toConsumableArray(e.result),t.loader.close()}),(function(e){t.loader.close()})))}},{key:"closeLoader",value:function(){this.loader.close()}},{key:"openPopUp",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;this.dialog.open(V,{width:"520px",disableClose:!0,data:{title:i?"Add New District":"Update District",payload:e}}).afterClosed().subscribe((function(a){a&&(t.loader.open(),t.subscripition.add(i?t.locationApiService.addDistrict(a).subscribe((function(e){t.loader.close(),"success"===e.status&&(t.getDistrict(e.result._id,"add"),t.snack.open("District Added!","OK",{duration:4e3}))}),(function(e){t.loader.close()})):t.locationApiService.updateDistrict(e._id,a).subscribe((function(e){t.loader.close(),"success"===e.status&&(t.getDistrict(e.result._id,"update"),t.snack.open("District Updated!","OK",{duration:4e3}))}),(function(e){t.loader.close()}))))}))}},{key:"getDistrict",value:function(t,e){var i=this;this.subscripition.add(this.locationApiService.getDistrict(t).subscribe((function(t){"add"===e?(i.districts.push(t.result),i.districts=_toConsumableArray(i.districts)):i.districts.forEach((function(e,a){e._id===t.result._id&&(i.districts[a]=t.result,i.districts=_toConsumableArray(i.districts))}))}),(function(t){i.loader.close()})))}},{key:"deleteItem",value:function(t){var e=this;this.subscripition.add(this.confirmService.confirm({message:"Delete ".concat(t.name,"?")}).subscribe((function(i){i&&(e.loader.open(),e.districts.forEach((function(i,a){i._id===t._id&&e.districts.splice(a,1)})),e.districts=_toConsumableArray(e.districts),e.locationApiService.deleteDistrict(t._id).subscribe((function(t){e.loader.close(),"success"===t.status&&e.snack.open("District deleted!","OK",{duration:4e3})})))}),(function(t){e.loader.close()})))}},{key:"statusChange",value:function(t,e){var i=this;this.loader.open(),this.subscripition.add(this.locationApiService.updateDistrict(t._id,{status:e.checked?"active":"inactive"}).subscribe((function(e){i.loader.close(),"success"===e.status&&(i.getDistrict(t._id,"update"),i.snack.open("Status Updated!","OK",{duration:4e3}))}),(function(t){i.loader.close()})))}},{key:"ngOnDestroy",value:function(){this.subscripition.unsubscribe()}}]),t}()).\u0275fac=function(t){return new(t||B)(r.Vb(c.b),r.Vb(w.a),r.Vb(x),r.Vb(g.a),r.Vb(C.a))},B.\u0275cmp=r.Pb({type:B,selectors:[["app-district"]],decls:18,vars:18,consts:[[1,"m-333"],["mat-raised-button","","color","primary",1,"mb-05",3,"click"],[1,"p-0"],[1,"material","ml-0","mr-0",3,"rows","columnMode","headerHeight","footerHeight","scrollbarH","limit","rowHeight"],["name","District",3,"flexGrow"],["ngx-datatable-cell-template",""],["name","District Code",3,"flexGrow"],["name","State",3,"flexGrow"],["name","Active",3,"flexGrow"],["name","Actions",3,"flexGrow"],[3,"checked","change"],["mat-icon-button","","mat-sm-button","","color","primary",1,"mr-1",3,"click"],["mat-icon-button","","mat-sm-button","","color","warn",3,"click"]],template:function(t,e){1&t&&(r.bc(0,"div",0),r.bc(1,"button",1),r.jc("click",(function(t){return e.openPopUp({},!0)})),r.Pc(2),r.oc(3,"translate"),r.oc(4,"translate"),r.ac(),r.ac(),r.bc(5,"mat-card",2),r.bc(6,"mat-card-content",2),r.bc(7,"ngx-datatable",3),r.bc(8,"ngx-datatable-column",4),r.Nc(9,j,1,1,"ng-template",5),r.ac(),r.bc(10,"ngx-datatable-column",6),r.Nc(11,W,1,1,"ng-template",5),r.ac(),r.bc(12,"ngx-datatable-column",7),r.Nc(13,H,1,1,"ng-template",5),r.ac(),r.bc(14,"ngx-datatable-column",8),r.Nc(15,N,1,1,"ng-template",5),r.ac(),r.bc(16,"ngx-datatable-column",9),r.Nc(17,L,6,0,"ng-template",5),r.ac(),r.ac(),r.ac(),r.ac()),2&t&&(r.Gb(2),r.Sc(" ",r.pc(3,14,"ADD")," ",r.pc(4,16,"District")," "),r.Gb(5),r.sc("rows",e.districts)("columnMode","force")("headerHeight",50)("footerHeight",50)("scrollbarH",!0)("limit",10)("rowHeight",50),r.Gb(1),r.sc("flexGrow",1),r.Gb(2),r.sc("flexGrow",1),r.Gb(2),r.sc("flexGrow",1),r.Gb(2),r.sc("flexGrow",1),r.Gb(2),r.sc("flexGrow",1))},directives:[u.b,S.a,S.b,A.d,A.b,A.a,_.a,P.a],pipes:[p.c],styles:[""]}),B);function K(t,e){if(1&t&&(r.bc(0,"mat-option",14),r.Pc(1),r.ac()),2&t){var i=e.$implicit;r.sc("value",i._id),r.Gb(1),r.Qc(i.name)}}function q(t,e){if(1&t&&(r.bc(0,"mat-option",14),r.Pc(1),r.ac()),2&t){var i=e.$implicit;r.sc("value",i._id),r.Gb(1),r.Qc(i.name)}}function X(t,e){1&t&&(r.bc(0,"p",15),r.Pc(1,"*Please fill all the fields"),r.ac())}var Y,$=((Y=function(){function t(e,i,a,o,n){_classCallCheck(this,t),this.data=e,this.dialogRef=i,this.fb=a,this.locationApiService=o,this.loader=n,this.subscripition=new k.a,this.states=[],this.Districts=[]}return _createClass(t,[{key:"ngOnInit",value:function(){this.loader.open(),this.getStates(),this.getDistricts(),this.buildItemForm(this.data.payload)}},{key:"getStates",value:function(){var t=this;this.subscripition.add(this.locationApiService.getStates().subscribe((function(e){t.states=e.result}),(function(e){t.loader.close()})))}},{key:"getDistricts",value:function(){var t=this;this.subscripition.add(this.locationApiService.getDistricts().subscribe((function(e){t.Districts=e.result,t.loader.close()}),(function(e){t.loader.close()})))}},{key:"buildItemForm",value:function(t){var e,i,a,o;this.itemForm=this.fb.group({name:[t.name||null,n.t.required],state:[(null===(i=null===(e=t)||void 0===e?void 0:e.state)||void 0===i?void 0:i._id)||null,n.t.required],district:[(null===(o=null===(a=t)||void 0===a?void 0:a.district)||void 0===o?void 0:o._id)||null,n.t.required]})}},{key:"submit",value:function(){this.itemForm.value.name=this.itemForm.value.name.trim(),this.itemForm.value.name.length>0?this.dialogRef.close(this.itemForm.value):this.validationErrors=!0}},{key:"ngOnDestroy",value:function(){this.loader.close(),this.subscripition.unsubscribe()}}]),t}()).\u0275fac=function(t){return new(t||Y)(r.Vb(c.a),r.Vb(c.f),r.Vb(n.c),r.Vb(x),r.Vb(g.a))},Y.\u0275cmp=r.Pb({type:Y,selectors:[["app-region-popup"]],decls:22,vars:9,consts:[["matDialogTitle",""],[3,"formGroup","ngSubmit"],["fxLayout","row wrap","fxLayout.lt-sm","column"],["fxFlex","50",1,"pr-1"],[1,"full-width","p-b-10"],["placeholder","Select State","name","state","formControlName","state",1,"full-width","state-box"],["ngDefaultControl","",3,"value",4,"ngFor","ngForOf"],["placeholder","Select District","name","state","formControlName","district",1,"full-width","state-box"],["matInput","","name","region","formControlName","name","placeholder","Region"],["class","error-msg",4,"ngIf"],["fxFlex","100",1,"mt-1"],["mat-raised-button","","color","primary",3,"disabled"],["fxFlex",""],["mat-button","","color","warn","type","button",3,"click"],["ngDefaultControl","",3,"value"],[1,"error-msg"]],template:function(t,e){1&t&&(r.bc(0,"h1",0),r.Pc(1),r.ac(),r.bc(2,"form",1),r.jc("ngSubmit",(function(t){return e.submit()})),r.bc(3,"div",2),r.bc(4,"div",3),r.bc(5,"mat-form-field",4),r.bc(6,"mat-select",5),r.Nc(7,K,2,2,"mat-option",6),r.ac(),r.ac(),r.bc(8,"mat-form-field",4),r.bc(9,"mat-select",7),r.Nc(10,q,2,2,"mat-option",6),r.ac(),r.ac(),r.ac(),r.bc(11,"div",3),r.bc(12,"mat-form-field",4),r.Wb(13,"input",8),r.ac(),r.ac(),r.Nc(14,X,2,0,"p",9),r.bc(15,"div",10),r.bc(16,"button",11),r.Pc(17),r.oc(18,"translate"),r.ac(),r.Wb(19,"span",12),r.bc(20,"button",13),r.jc("click",(function(t){return e.dialogRef.close(!1)})),r.Pc(21,"Cancel"),r.ac(),r.ac(),r.ac(),r.ac()),2&t&&(r.Gb(1),r.Qc(e.data.title),r.Gb(1),r.sc("formGroup",e.itemForm),r.Gb(5),r.sc("ngForOf",e.states),r.Gb(3),r.sc("ngForOf",e.Districts),r.Gb(4),r.sc("ngIf",e.validationErrors),r.Gb(2),r.sc("disabled",e.itemForm.invalid),r.Gb(1),r.Qc(r.pc(18,7,"SAVE")))},directives:[c.g,n.u,n.o,n.h,s.b,z.a,n.n,n.f,a.k,l.b,n.b,a.l,u.b,E.p],pipes:[p.c],styles:[".p-b-10[_ngcontent-%COMP%]{padding-bottom:10px}.error-msg[_ngcontent-%COMP%]{color:red}"]}),Y);function J(t,e){if(1&t&&r.Pc(0),2&t){var i=e.row;r.Rc(" ",null==i?null:i.name," ")}}function Z(t,e){if(1&t&&r.Pc(0),2&t){var i=e.row;r.Rc(" ",null==i?null:i.state.name," ")}}function tt(t,e){if(1&t&&r.Pc(0),2&t){var i=e.row;r.Rc(" ",null==i?null:i.district.name," ")}}function et(t,e){if(1&t){var i=r.cc();r.bc(0,"mat-slide-toggle",10),r.jc("change",(function(t){r.Gc(i);var a=e.row;return r.nc().statusChange(a,t)})),r.ac()}if(2&t){var a=e.row;r.sc("checked","active"===(null==a?null:a.status))}}function it(t,e){if(1&t){var i=r.cc();r.bc(0,"button",11),r.jc("click",(function(t){r.Gc(i);var a=e.row;return r.nc().openPopUp(a)})),r.bc(1,"mat-icon"),r.Pc(2,"edit"),r.ac(),r.ac(),r.bc(3,"button",12),r.jc("click",(function(t){r.Gc(i);var a=e.row;return r.nc().deleteItem(a)})),r.bc(4,"mat-icon"),r.Pc(5,"delete"),r.ac(),r.ac()}}var at,ot,nt,ct=((at=function(){function t(e,i,a,o,n){_classCallCheck(this,t),this.dialog=e,this.snack=i,this.locationApiService=a,this.confirmService=o,this.loader=n,this.subscripition=new k.a,this.regions=[]}return _createClass(t,[{key:"ngOnInit",value:function(){this.loader.open(),this.getStates()}},{key:"getStates",value:function(){var t=this;this.subscripition.add(this.locationApiService.getRegions().subscribe((function(e){t.regions=_toConsumableArray(e.result),t.loader.close()}),(function(e){t.loader.close()})))}},{key:"openPopUp",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;this.dialog.open($,{width:"520px",disableClose:!0,data:{title:i?"Add New Region":"Update Region",payload:e}}).afterClosed().subscribe((function(a){a&&(t.loader.open(),t.subscripition.add(i?t.locationApiService.addRegion(a).subscribe((function(e){t.loader.close(),"success"===e.status&&(t.getRegion(e.result._id,"add"),t.snack.open("Region Added!","OK",{duration:4e3}))}),(function(e){t.loader.close()})):t.locationApiService.updateRegion(e._id,a).subscribe((function(e){t.loader.close(),"success"===e.status&&(t.getRegion(e.result._id,"update"),t.snack.open("Region Updated!","OK",{duration:4e3}))}),(function(e){t.loader.close()}))))}))}},{key:"getRegion",value:function(t,e){var i=this;this.subscripition.add(this.locationApiService.getRegion(t).subscribe((function(t){"add"===e?(i.regions.push(t.result),i.regions=_toConsumableArray(i.regions)):i.regions.forEach((function(e,a){e._id===t.result._id&&(i.regions[a]=t.result,i.regions=_toConsumableArray(i.regions))}))}),(function(t){i.loader.close()})))}},{key:"deleteItem",value:function(t){var e=this;this.confirmService.confirm({message:"Delete ".concat(t.name,"?")}).subscribe((function(i){i&&(e.loader.open(),e.regions.forEach((function(i,a){i._id===t._id&&e.regions.splice(a,1)})),e.regions=_toConsumableArray(e.regions),e.subscripition.add(e.locationApiService.deleteRegion(t._id).subscribe((function(t){e.loader.close(),"success"===t.status&&e.snack.open("Region deleted!","OK",{duration:4e3})}),(function(t){e.loader.close()}))))}))}},{key:"statusChange",value:function(t,e){var i=this;this.loader.open(),this.subscripition.add(this.locationApiService.updateRegion(t._id,{status:e.checked?"active":"inactive"}).subscribe((function(e){i.loader.close(),"success"===e.status&&(i.getRegion(t._id,"update"),i.snack.open("Status Updated!","OK",{duration:4e3}))}),(function(t){i.loader.close()})))}},{key:"ngOnDestroy",value:function(){this.subscripition.unsubscribe()}}]),t}()).\u0275fac=function(t){return new(t||at)(r.Vb(c.b),r.Vb(w.a),r.Vb(x),r.Vb(C.a),r.Vb(g.a))},at.\u0275cmp=r.Pb({type:at,selectors:[["app-region"]],decls:18,vars:18,consts:[[1,"m-333"],["mat-raised-button","","color","primary",1,"mb-05",3,"click"],[1,"p-0"],[1,"material","ml-0","mr-0",3,"rows","columnMode","headerHeight","footerHeight","scrollbarH","limit","rowHeight"],["name","Region",3,"flexGrow"],["ngx-datatable-cell-template",""],["name","State",3,"flexGrow"],["name","District",3,"flexGrow"],["name","Active",3,"flexGrow"],["name","Actions",3,"flexGrow"],[3,"checked","change"],["mat-icon-button","","mat-sm-button","","color","primary",1,"mr-1",3,"click"],["mat-icon-button","","mat-sm-button","","color","warn",3,"click"]],template:function(t,e){1&t&&(r.bc(0,"div",0),r.bc(1,"button",1),r.jc("click",(function(t){return e.openPopUp({},!0)})),r.Pc(2),r.oc(3,"translate"),r.oc(4,"translate"),r.ac(),r.ac(),r.bc(5,"mat-card",2),r.bc(6,"mat-card-content",2),r.bc(7,"ngx-datatable",3),r.bc(8,"ngx-datatable-column",4),r.Nc(9,J,1,1,"ng-template",5),r.ac(),r.bc(10,"ngx-datatable-column",6),r.Nc(11,Z,1,1,"ng-template",5),r.ac(),r.bc(12,"ngx-datatable-column",7),r.Nc(13,tt,1,1,"ng-template",5),r.ac(),r.bc(14,"ngx-datatable-column",8),r.Nc(15,et,1,1,"ng-template",5),r.ac(),r.bc(16,"ngx-datatable-column",9),r.Nc(17,it,6,0,"ng-template",5),r.ac(),r.ac(),r.ac(),r.ac()),2&t&&(r.Gb(2),r.Sc("",r.pc(3,14,"ADD")," ",r.pc(4,16,"Region"),""),r.Gb(5),r.sc("rows",e.regions)("columnMode","force")("headerHeight",50)("footerHeight",50)("scrollbarH",!0)("limit",10)("rowHeight",50),r.Gb(1),r.sc("flexGrow",1),r.Gb(2),r.sc("flexGrow",1),r.Gb(2),r.sc("flexGrow",1),r.Gb(2),r.sc("flexGrow",1),r.Gb(2),r.sc("flexGrow",1))},directives:[u.b,S.a,S.b,A.d,A.b,A.a,_.a,P.a],pipes:[p.c],styles:[""]}),at),rt=i("hOig"),st=((nt=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||nt)},nt.\u0275cmp=r.Pb({type:nt,selectors:[["app-dashboard"]],decls:1,vars:0,template:function(t,e){1&t&&r.Wb(0,"app-admin-layout")},directives:[rt.a],styles:[""]}),nt),lt=((ot=function(){function t(e){_classCallCheck(this,t),this.http=e,this.apiUrl=v.a.apiURL}return _createClass(t,[{key:"getCategorys",value:function(){return this.http.get(this.apiUrl+"product/category/list")}},{key:"getCategory",value:function(t){return this.http.get(this.apiUrl+"product/category/details/"+t)}},{key:"deleteCategory",value:function(t){return this.http.get(this.apiUrl+"product/category/delete/"+t)}},{key:"addCategory",value:function(t){return this.http.post(this.apiUrl+"product/category/add",t)}},{key:"updateCategory",value:function(t,e){return this.http.post(this.apiUrl+"product/category/update/"+t,e)}},{key:"imageUpload",value:function(t,e){return this.http.post(this.apiUrl+"product/category/image/update/"+t,e)}},{key:"addProduct",value:function(t){return this.http.post(this.apiUrl+"product/item/add",t)}},{key:"updateProduct",value:function(t,e){return this.http.post(this.apiUrl+"product/item/update/"+t,e)}},{key:"updateProductImage",value:function(t,e){return this.http.post(this.apiUrl+"product/item/image/update/"+t,e)}},{key:"getProduct",value:function(t){return this.http.get(this.apiUrl+"product/item/details/"+t)}},{key:"getAllProducts",value:function(){return this.http.get(this.apiUrl+"product/item/list")}},{key:"deleteProduct",value:function(t){return this.http.get(this.apiUrl+"product/item/delete/"+t)}},{key:"productImageUpload",value:function(t,e){return this.http.post(this.apiUrl+"product/item/image/update/"+t,e)}},{key:"addAttribute",value:function(t){return this.http.post(this.apiUrl+"product/attribute/add",t)}},{key:"updateAttribute",value:function(t,e){return this.http.post(this.apiUrl+"product/attribute/update/"+t,e)}},{key:"getAllAttribute",value:function(){return this.http.get(this.apiUrl+"product/attribute/list")}},{key:"getAttribute",value:function(t){return this.http.get(this.apiUrl+"product/attribute/details/"+t)}},{key:"deleteAttribute",value:function(t){return this.http.get(this.apiUrl+"product/attribute/delete/"+t)}},{key:"addSpecification",value:function(t){return t.item=t.item._id,this.http.post(this.apiUrl+"product/specification/add",t)}},{key:"updateSpecification",value:function(t,e){return this.http.post(this.apiUrl+"product/specification/update/"+t,e)}},{key:"getAllSpecification",value:function(){return this.http.get(this.apiUrl+"product/specification/list")}},{key:"getSpecification",value:function(t){return this.http.get(this.apiUrl+"product/specification/details/"+t)}},{key:"deleteSpecification",value:function(t){return this.http.delete(this.apiUrl+"product/specification/remove/"+t)}}]),t}()).\u0275fac=function(t){return new(t||ot)(r.fc(y.c))},ot.\u0275prov=r.Rb({token:ot,factory:ot.\u0275fac,providedIn:"root"}),ot),ut=i("jhN1"),pt=["wrapper"],ht=["sourceImage"];function dt(t,e){if(1&t){var i=r.cc();r.bc(0,"img",4,5),r.jc("load",(function(t){return r.Gc(i),r.nc().imageLoadedInView()})),r.ac()}if(2&t){var a=r.nc();r.Mc("visibility",a.imageVisible?"visible":"hidden")("transform",a.safeTransformStyle),r.sc("src",a.safeImgDataUrl,r.Ic)}}function mt(t,e){if(1&t){var i=r.cc();r.Zb(0),r.bc(1,"span",9),r.jc("mousedown",(function(t){r.Gc(i);var e=r.nc(2);return e.startMove(t,e.moveTypes.Resize,"topleft")}))("touchstart",(function(t){r.Gc(i);var e=r.nc(2);return e.startMove(t,e.moveTypes.Resize,"topleft")})),r.Wb(2,"span",10),r.ac(),r.bc(3,"span",11),r.Wb(4,"span",10),r.ac(),r.bc(5,"span",12),r.jc("mousedown",(function(t){r.Gc(i);var e=r.nc(2);return e.startMove(t,e.moveTypes.Resize,"topright")}))("touchstart",(function(t){r.Gc(i);var e=r.nc(2);return e.startMove(t,e.moveTypes.Resize,"topright")})),r.Wb(6,"span",10),r.ac(),r.bc(7,"span",13),r.Wb(8,"span",10),r.ac(),r.bc(9,"span",14),r.jc("mousedown",(function(t){r.Gc(i);var e=r.nc(2);return e.startMove(t,e.moveTypes.Resize,"bottomright")}))("touchstart",(function(t){r.Gc(i);var e=r.nc(2);return e.startMove(t,e.moveTypes.Resize,"bottomright")})),r.Wb(10,"span",10),r.ac(),r.bc(11,"span",15),r.Wb(12,"span",10),r.ac(),r.bc(13,"span",16),r.jc("mousedown",(function(t){r.Gc(i);var e=r.nc(2);return e.startMove(t,e.moveTypes.Resize,"bottomleft")}))("touchstart",(function(t){r.Gc(i);var e=r.nc(2);return e.startMove(t,e.moveTypes.Resize,"bottomleft")})),r.Wb(14,"span",10),r.ac(),r.bc(15,"span",17),r.Wb(16,"span",10),r.ac(),r.bc(17,"span",18),r.jc("mousedown",(function(t){r.Gc(i);var e=r.nc(2);return e.startMove(t,e.moveTypes.Resize,"top")}))("touchstart",(function(t){r.Gc(i);var e=r.nc(2);return e.startMove(t,e.moveTypes.Resize,"top")})),r.ac(),r.bc(18,"span",19),r.jc("mousedown",(function(t){r.Gc(i);var e=r.nc(2);return e.startMove(t,e.moveTypes.Resize,"right")}))("touchstart",(function(t){r.Gc(i);var e=r.nc(2);return e.startMove(t,e.moveTypes.Resize,"right")})),r.ac(),r.bc(19,"span",20),r.jc("mousedown",(function(t){r.Gc(i);var e=r.nc(2);return e.startMove(t,e.moveTypes.Resize,"bottom")}))("touchstart",(function(t){r.Gc(i);var e=r.nc(2);return e.startMove(t,e.moveTypes.Resize,"bottom")})),r.ac(),r.bc(20,"span",21),r.jc("mousedown",(function(t){r.Gc(i);var e=r.nc(2);return e.startMove(t,e.moveTypes.Resize,"left")}))("touchstart",(function(t){r.Gc(i);var e=r.nc(2);return e.startMove(t,e.moveTypes.Resize,"left")})),r.ac(),r.Yb()}}function ft(t,e){if(1&t){var i=r.cc();r.bc(0,"div",6),r.jc("keydown",(function(t){return r.Gc(i),r.nc().keyboardAccess(t)})),r.bc(1,"div",7),r.jc("mousedown",(function(t){r.Gc(i);var e=r.nc();return e.startMove(t,e.moveTypes.Move)}))("touchstart",(function(t){r.Gc(i);var e=r.nc();return e.startMove(t,e.moveTypes.Move)})),r.ac(),r.Nc(2,mt,21,0,"ng-container",8),r.ac()}if(2&t){var a=r.nc();r.Mc("top",a.cropper.y1,"px")("left",a.cropper.x1,"px")("width",a.cropper.x2-a.cropper.x1,"px")("height",a.cropper.y2-a.cropper.y1,"px")("margin-left","center"===a.alignImage?a.marginLeft:null)("visibility",a.imageVisible?"visible":"hidden"),r.Lb("rounded",a.roundCropper),r.Gb(2),r.sc("ngIf",!a.hideResizeSquares)}}var gt,bt,vt={Move:"move",Resize:"resize",Pinch:"pinch"},yt=((bt=function(){function t(e,i){_classCallCheck(this,t),this.sanitizer=e,this.cd=i,this.Hammer="undefined"!=typeof window?window.Hammer:null,this.setImageMaxSizeRetries=0,this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.exifTransform={rotate:0,flip:!1},this.autoRotateSupported=new Promise((function(t){var e=new Image;e.onload=function(){t(1===e.width&&2===e.height)},e.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=="})),this.stepSize=3,this.marginLeft="0px",this.imageVisible=!1,this.moveTypes=vt,this.format="png",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.cropperStaticWidth=0,this.cropperStaticHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.cropper={x1:-100,y1:-100,x2:1e4,y2:1e4},this.alignImage="center",this.disabled=!1,this.imageCropped=new r.o,this.startCropImage=new r.o,this.imageLoaded=new r.o,this.cropperReady=new r.o,this.loadImageFailed=new r.o,this.initCropper()}return _createClass(t,[{key:"ngOnChanges",value:function(t){this.cropperStaticHeight&&this.cropperStaticWidth&&(this.hideResizeSquares=!0,this.cropperMinWidth=this.cropperStaticWidth,this.cropperMinHeight=this.cropperStaticHeight,this.maintainAspectRatio=!1),this.onChangesInputImage(t),this.originalImage&&this.originalImage.complete&&this.exifTransform&&(t.containWithinAspectRatio||t.canvasRotation)&&this.transformOriginalImage(),t.cropper&&(this.setMaxSize(),this.setCropperScaledMinSize(),this.checkCropperPosition(!1),this.doAutoCrop(),this.cd.markForCheck()),t.aspectRatio&&this.imageVisible&&this.resetCropperPosition(),t.transform&&(this.transform=this.transform||{},this.setCssTransform(),this.doAutoCrop())}},{key:"onChangesInputImage",value:function(t){(t.imageChangedEvent||t.imageURL||t.imageBase64||t.imageFile)&&this.initCropper(),t.imageChangedEvent&&this.isValidImageChangedEvent()&&this.loadImageFile(this.imageChangedEvent.target.files[0]),t.imageURL&&this.imageURL&&this.loadImageFromURL(this.imageURL),t.imageBase64&&this.imageBase64&&this.loadBase64Image(this.imageBase64),t.imageFile&&this.imageFile&&this.loadImageFile(this.imageFile)}},{key:"isValidImageChangedEvent",value:function(){return this.imageChangedEvent&&this.imageChangedEvent.target&&this.imageChangedEvent.target.files&&this.imageChangedEvent.target.files.length>0}},{key:"setCssTransform",value:function(){this.safeTransformStyle=this.sanitizer.bypassSecurityTrustStyle("scaleX("+(this.transform.scale||1)*(this.transform.flipH?-1:1)+")scaleY("+(this.transform.scale||1)*(this.transform.flipV?-1:1)+")rotate("+(this.transform.rotate||0)+"deg)")}},{key:"ngOnInit",value:function(){this.stepSize=this.initialStepSize,this.activatePinchGesture()}},{key:"initCropper",value:function(){this.imageVisible=!1,this.transformedImage=null,this.safeImgDataUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",this.moveStart={active:!1,type:null,position:null,x1:0,y1:0,x2:0,y2:0,clientX:0,clientY:0},this.maxSize={width:0,height:0},this.originalSize={width:0,height:0},this.transformedSize={width:0,height:0},this.cropper.x1=-100,this.cropper.y1=-100,this.cropper.x2=1e4,this.cropper.y2=1e4}},{key:"loadImage",value:function(t,e){this.isValidImageType(e)?this.loadBase64Image(t):this.loadImageFailed.emit()}},{key:"loadImageFile",value:function(t){var e=this,i=new FileReader;i.onload=function(i){return e.loadImage(i.target.result,t.type)},i.readAsDataURL(t)}},{key:"isValidImageType",value:function(t){return/image\/(png|jpg|jpeg|bmp|gif|tiff|webp)/.test(t)}},{key:"loadBase64Image",value:function(t){var e=this;this.autoRotateSupported.then((function(i){return e.checkExifAndLoadBase64Image(t,i)})).then((function(){return e.transformOriginalImage()})).catch((function(t){e.loadImageFailed.emit(),e.originalImage=null,e.originalBase64=null,console.error(t)}))}},{key:"checkExifAndLoadBase64Image",value:function(t,e){var i=this;return new Promise((function(a,o){i.originalImage=new Image,i.originalImage.onload=function(){i.originalBase64=t,i.exifTransform=function(t){switch("string"==typeof t&&(t=function(t){var e=new DataView(function(t){t=t.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var e=atob(t),i=e.length,a=new Uint8Array(i),o=0;o<i;o++)a[o]=e.charCodeAt(o);return a.buffer}(t));if(65496!=e.getUint16(0,!1))return-2;for(var i=e.byteLength,a=2;a<i;){if(e.getUint16(a+2,!1)<=8)return-1;var o=e.getUint16(a,!1);if(a+=2,65505==o){if(1165519206!=e.getUint32(a+=2,!1))return-1;var n=18761==e.getUint16(a+=6,!1);a+=e.getUint32(a+4,n);var c=e.getUint16(a,n);a+=2;for(var r=0;r<c;r++)if(274==e.getUint16(a+12*r,n))return e.getUint16(a+12*r+8,n)}else{if(65280!=(65280&o))break;a+=e.getUint16(a,!1)}}return-1}(t)),t){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}(e?-1:t),i.originalSize.width=i.originalImage.naturalWidth,i.originalSize.height=i.originalImage.naturalHeight,a()},i.originalImage.onerror=o,i.originalImage.src=t}))}},{key:"loadImageFromURL",value:function(t){var e=this,i=new Image;i.onerror=function(){return e.loadImageFailed.emit()},i.onload=function(){var t=document.createElement("canvas"),a=t.getContext("2d");t.width=i.width,t.height=i.height,a.drawImage(i,0,0),e.loadBase64Image(t.toDataURL())},i.crossOrigin="anonymous",i.src=t}},{key:"transformOriginalImage",value:function(){if(!this.originalImage||!this.originalImage.complete||!this.exifTransform)return Promise.reject(new Error("No image loaded"));var t=this.transformImageBase64();return this.setTransformedImage(t)}},{key:"transformImageBase64",value:function(){var t=this.canvasRotation+this.exifTransform.rotate;if(0===t&&!this.exifTransform.flip&&!this.containWithinAspectRatio)return this.originalBase64;var e=this.getTransformedSize(),i=document.createElement("canvas");i.width=e.width,i.height=e.height;var a=i.getContext("2d");return a.setTransform(this.exifTransform.flip?-1:1,0,0,1,i.width/2,i.height/2),a.rotate(Math.PI*(t/2)),a.drawImage(this.originalImage,-this.originalSize.width/2,-this.originalSize.height/2),i.toDataURL()}},{key:"getTransformedSize",value:function(){var t=this.canvasRotation+this.exifTransform.rotate;if(this.containWithinAspectRatio){if(t%2){var e=this.originalSize.height/this.aspectRatio;return{width:Math.max(this.originalSize.height,this.originalSize.width*this.aspectRatio),height:Math.max(this.originalSize.width,e)}}var i=this.originalSize.width/this.aspectRatio;return{width:Math.max(this.originalSize.width,this.originalSize.height*this.aspectRatio),height:Math.max(this.originalSize.height,i)}}return t%2?{height:this.originalSize.width,width:this.originalSize.height}:{width:this.originalSize.width,height:this.originalSize.height}}},{key:"setTransformedImage",value:function(t){var e=this;return new Promise((function(i){e.transformedBase64=t,e.safeImgDataUrl=e.sanitizer.bypassSecurityTrustResourceUrl(t),e.transformedImage=new Image,e.transformedImage.onload=function(){e.transformedSize.width=e.transformedImage.naturalWidth,e.transformedSize.height=e.transformedImage.naturalHeight,e.cd.markForCheck(),i()},e.transformedImage.src=e.transformedBase64}))}},{key:"imageLoadedInView",value:function(){var t=this;null!=this.transformedImage&&(this.imageLoaded.emit(),this.setImageMaxSizeRetries=0,setTimeout((function(){return t.checkImageMaxSizeRecursively()})))}},{key:"checkImageMaxSizeRecursively",value:function(){var t=this;this.setImageMaxSizeRetries>40?this.loadImageFailed.emit():this.sourceImageLoaded()?(this.setMaxSize(),this.setCropperScaledMinSize(),this.resetCropperPosition(),this.cropperReady.emit(Object.assign({},this.maxSize)),this.cd.markForCheck()):(this.setImageMaxSizeRetries++,setTimeout((function(){return t.checkImageMaxSizeRecursively()}),50))}},{key:"sourceImageLoaded",value:function(){return this.sourceImage&&this.sourceImage.nativeElement&&this.sourceImage.nativeElement.offsetWidth>0}},{key:"onResize",value:function(){this.resizeCropperPosition(),this.setMaxSize(),this.setCropperScaledMinSize()}},{key:"activatePinchGesture",value:function(){if(this.Hammer){var t=new this.Hammer(this.wrapper.nativeElement);t.get("pinch").set({enable:!0}),t.on("pinchmove",this.onPinch.bind(this)),t.on("pinchend",this.pinchStop.bind(this)),t.on("pinchstart",this.startPinch.bind(this))}else Object(r.Z)()&&console.warn("[NgxImageCropper] Could not find HammerJS - Pinch Gesture won't work")}},{key:"resizeCropperPosition",value:function(){var t=this.sourceImage.nativeElement;this.maxSize.width===t.offsetWidth&&this.maxSize.height===t.offsetHeight||(this.cropper.x1=this.cropper.x1*t.offsetWidth/this.maxSize.width,this.cropper.x2=this.cropper.x2*t.offsetWidth/this.maxSize.width,this.cropper.y1=this.cropper.y1*t.offsetHeight/this.maxSize.height,this.cropper.y2=this.cropper.y2*t.offsetHeight/this.maxSize.height)}},{key:"resetCropperPosition",value:function(){var t=this.sourceImage.nativeElement;if(this.cropperStaticHeight&&this.cropperStaticWidth)this.cropper.x1=0,this.cropper.x2=t.offsetWidth>this.cropperStaticWidth?this.cropperStaticWidth:t.offsetWidth,this.cropper.y1=0,this.cropper.y2=t.offsetHeight>this.cropperStaticHeight?this.cropperStaticHeight:t.offsetHeight;else if(this.maintainAspectRatio)if(t.offsetWidth/this.aspectRatio<t.offsetHeight){this.cropper.x1=0,this.cropper.x2=t.offsetWidth;var e=t.offsetWidth/this.aspectRatio;this.cropper.y1=(t.offsetHeight-e)/2,this.cropper.y2=this.cropper.y1+e}else{this.cropper.y1=0,this.cropper.y2=t.offsetHeight;var i=t.offsetHeight*this.aspectRatio;this.cropper.x1=(t.offsetWidth-i)/2,this.cropper.x2=this.cropper.x1+i}else this.cropper.x1=0,this.cropper.x2=t.offsetWidth,this.cropper.y1=0,this.cropper.y2=t.offsetHeight;this.doAutoCrop(),this.imageVisible=!0}},{key:"keyboardAccess",value:function(t){this.changeKeyboardStepSize(t),this.keyboardMoveCropper(t)}},{key:"changeKeyboardStepSize",value:function(t){t.key>="1"&&t.key<="9"&&(this.stepSize=+t.key)}},{key:"keyboardMoveCropper",value:function(t){if(["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(t.key)){var e=t.shiftKey?vt.Resize:vt.Move,i=t.altKey?this.getInvertedPositionForKey(t.key):this.getPositionForKey(t.key),a=this.getEventForKey(t.key,this.stepSize);t.preventDefault(),t.stopPropagation(),this.startMove({clientX:0,clientY:0},e,i),this.moveImg(a),this.moveStop()}}},{key:"getPositionForKey",value:function(t){switch(t){case"ArrowUp":return"top";case"ArrowRight":return"right";case"ArrowDown":return"bottom";case"ArrowLeft":default:return"left"}}},{key:"getInvertedPositionForKey",value:function(t){switch(t){case"ArrowUp":return"bottom";case"ArrowRight":return"left";case"ArrowDown":return"top";case"ArrowLeft":default:return"right"}}},{key:"getEventForKey",value:function(t,e){switch(t){case"ArrowUp":return{clientX:0,clientY:-1*e};case"ArrowRight":return{clientX:e,clientY:0};case"ArrowDown":return{clientX:0,clientY:e};case"ArrowLeft":default:return{clientX:-1*e,clientY:0}}}},{key:"startMove",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.moveStart&&this.moveStart.active&&this.moveStart.type===vt.Pinch||(t.preventDefault&&t.preventDefault(),this.moveStart=Object.assign({active:!0,type:e,position:i,clientX:this.getClientX(t),clientY:this.getClientY(t)},this.cropper))}},{key:"startPinch",value:function(t){this.safeImgDataUrl&&(t.preventDefault&&t.preventDefault(),this.moveStart=Object.assign({active:!0,type:vt.Pinch,position:"center",clientX:this.cropper.x1+(this.cropper.x2-this.cropper.x1)/2,clientY:this.cropper.y1+(this.cropper.y2-this.cropper.y1)/2},this.cropper))}},{key:"moveImg",value:function(t){this.moveStart.active&&(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),this.moveStart.type===vt.Move?(this.move(t),this.checkCropperPosition(!0)):this.moveStart.type===vt.Resize&&(this.cropperStaticWidth||this.cropperStaticHeight||this.resize(t),this.checkCropperPosition(!1)),this.cd.detectChanges())}},{key:"onPinch",value:function(t){this.moveStart.active&&(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),this.moveStart.type===vt.Pinch&&(this.resize(t),this.checkCropperPosition(!1)),this.cd.detectChanges())}},{key:"setMaxSize",value:function(){if(this.sourceImage){var t=this.sourceImage.nativeElement;this.maxSize.width=t.offsetWidth,this.maxSize.height=t.offsetHeight,this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.maxSize.width/2+"px)")}}},{key:"setCropperScaledMinSize",value:function(){this.transformedImage?(this.setCropperScaledMinWidth(),this.setCropperScaledMinHeight()):(this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20)}},{key:"setCropperScaledMinWidth",value:function(){this.cropperScaledMinWidth=this.cropperMinWidth>0?Math.max(20,this.cropperMinWidth/this.transformedImage.width*this.maxSize.width):20}},{key:"setCropperScaledMinHeight",value:function(){this.cropperScaledMinHeight=this.maintainAspectRatio?Math.max(20,this.cropperScaledMinWidth/this.aspectRatio):this.cropperMinHeight>0?Math.max(20,this.cropperMinHeight/this.transformedImage.height*this.maxSize.height):20}},{key:"checkCropperPosition",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.cropper.x1<0&&(this.cropper.x2-=t?this.cropper.x1:0,this.cropper.x1=0),this.cropper.y1<0&&(this.cropper.y2-=t?this.cropper.y1:0,this.cropper.y1=0),this.cropper.x2>this.maxSize.width&&(this.cropper.x1-=t?this.cropper.x2-this.maxSize.width:0,this.cropper.x2=this.maxSize.width),this.cropper.y2>this.maxSize.height&&(this.cropper.y1-=t?this.cropper.y2-this.maxSize.height:0,this.cropper.y2=this.maxSize.height)}},{key:"moveStop",value:function(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}},{key:"pinchStop",value:function(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}},{key:"move",value:function(t){var e=this.getClientX(t)-this.moveStart.clientX,i=this.getClientY(t)-this.moveStart.clientY;this.cropper.x1=this.moveStart.x1+e,this.cropper.y1=this.moveStart.y1+i,this.cropper.x2=this.moveStart.x2+e,this.cropper.y2=this.moveStart.y2+i}},{key:"resize",value:function(t){var e=this.getClientX(t)-this.moveStart.clientX,i=this.getClientY(t)-this.moveStart.clientY;switch(this.moveStart.position){case"left":this.cropper.x1=Math.min(this.moveStart.x1+e,this.cropper.x2-this.cropperScaledMinWidth);break;case"topleft":this.cropper.x1=Math.min(this.moveStart.x1+e,this.cropper.x2-this.cropperScaledMinWidth),this.cropper.y1=Math.min(this.moveStart.y1+i,this.cropper.y2-this.cropperScaledMinHeight);break;case"top":this.cropper.y1=Math.min(this.moveStart.y1+i,this.cropper.y2-this.cropperScaledMinHeight);break;case"topright":this.cropper.x2=Math.max(this.moveStart.x2+e,this.cropper.x1+this.cropperScaledMinWidth),this.cropper.y1=Math.min(this.moveStart.y1+i,this.cropper.y2-this.cropperScaledMinHeight);break;case"right":this.cropper.x2=Math.max(this.moveStart.x2+e,this.cropper.x1+this.cropperScaledMinWidth);break;case"bottomright":this.cropper.x2=Math.max(this.moveStart.x2+e,this.cropper.x1+this.cropperScaledMinWidth),this.cropper.y2=Math.max(this.moveStart.y2+i,this.cropper.y1+this.cropperScaledMinHeight);break;case"bottom":this.cropper.y2=Math.max(this.moveStart.y2+i,this.cropper.y1+this.cropperScaledMinHeight);break;case"bottomleft":this.cropper.x1=Math.min(this.moveStart.x1+e,this.cropper.x2-this.cropperScaledMinWidth),this.cropper.y2=Math.max(this.moveStart.y2+i,this.cropper.y1+this.cropperScaledMinHeight);break;case"center":var a=t.scale,o=Math.abs(this.moveStart.x2-this.moveStart.x1)*a,n=Math.abs(this.moveStart.y2-this.moveStart.y1)*a,c=this.cropper.x1,r=this.cropper.y1;this.cropper.x1=Math.min(this.moveStart.clientX-o/2,this.cropper.x2-this.cropperScaledMinWidth),this.cropper.y1=Math.min(this.moveStart.clientY-n/2,this.cropper.y2-this.cropperScaledMinHeight),this.cropper.x2=Math.max(this.moveStart.clientX+o/2,c+this.cropperScaledMinWidth),this.cropper.y2=Math.max(this.moveStart.clientY+n/2,r+this.cropperScaledMinHeight)}this.maintainAspectRatio&&this.checkAspectRatio()}},{key:"checkAspectRatio",value:function(){var t=0,e=0;switch(this.moveStart.position){case"top":this.cropper.x2=this.cropper.x1+(this.cropper.y2-this.cropper.y1)*this.aspectRatio,t=Math.max(this.cropper.x2-this.maxSize.width,0),e=Math.max(0-this.cropper.y1,0),(t>0||e>0)&&(this.cropper.x2-=e*this.aspectRatio>t?e*this.aspectRatio:t,this.cropper.y1+=e*this.aspectRatio>t?e:t/this.aspectRatio);break;case"bottom":this.cropper.x2=this.cropper.x1+(this.cropper.y2-this.cropper.y1)*this.aspectRatio,t=Math.max(this.cropper.x2-this.maxSize.width,0),e=Math.max(this.cropper.y2-this.maxSize.height,0),(t>0||e>0)&&(this.cropper.x2-=e*this.aspectRatio>t?e*this.aspectRatio:t,this.cropper.y2-=e*this.aspectRatio>t?e:t/this.aspectRatio);break;case"topleft":this.cropper.y1=this.cropper.y2-(this.cropper.x2-this.cropper.x1)/this.aspectRatio,t=Math.max(0-this.cropper.x1,0),e=Math.max(0-this.cropper.y1,0),(t>0||e>0)&&(this.cropper.x1+=e*this.aspectRatio>t?e*this.aspectRatio:t,this.cropper.y1+=e*this.aspectRatio>t?e:t/this.aspectRatio);break;case"topright":this.cropper.y1=this.cropper.y2-(this.cropper.x2-this.cropper.x1)/this.aspectRatio,t=Math.max(this.cropper.x2-this.maxSize.width,0),e=Math.max(0-this.cropper.y1,0),(t>0||e>0)&&(this.cropper.x2-=e*this.aspectRatio>t?e*this.aspectRatio:t,this.cropper.y1+=e*this.aspectRatio>t?e:t/this.aspectRatio);break;case"right":case"bottomright":this.cropper.y2=this.cropper.y1+(this.cropper.x2-this.cropper.x1)/this.aspectRatio,t=Math.max(this.cropper.x2-this.maxSize.width,0),e=Math.max(this.cropper.y2-this.maxSize.height,0),(t>0||e>0)&&(this.cropper.x2-=e*this.aspectRatio>t?e*this.aspectRatio:t,this.cropper.y2-=e*this.aspectRatio>t?e:t/this.aspectRatio);break;case"left":case"bottomleft":this.cropper.y2=this.cropper.y1+(this.cropper.x2-this.cropper.x1)/this.aspectRatio,t=Math.max(0-this.cropper.x1,0),e=Math.max(this.cropper.y2-this.maxSize.height,0),(t>0||e>0)&&(this.cropper.x1+=e*this.aspectRatio>t?e*this.aspectRatio:t,this.cropper.y2-=e*this.aspectRatio>t?e:t/this.aspectRatio);break;case"center":this.cropper.x2=this.cropper.x1+(this.cropper.y2-this.cropper.y1)*this.aspectRatio,this.cropper.y2=this.cropper.y1+(this.cropper.x2-this.cropper.x1)/this.aspectRatio;var i=Math.max(0-this.cropper.x1,0),a=Math.max(this.cropper.x2-this.maxSize.width,0),o=Math.max(this.cropper.y2-this.maxSize.height,0),n=Math.max(0-this.cropper.y1,0);(i>0||a>0||o>0||n>0)&&(this.cropper.x1+=o*this.aspectRatio>i?o*this.aspectRatio:i,this.cropper.x2-=n*this.aspectRatio>a?n*this.aspectRatio:a,this.cropper.y1+=n*this.aspectRatio>a?n:a/this.aspectRatio,this.cropper.y2-=o*this.aspectRatio>i?o:i/this.aspectRatio)}}},{key:"doAutoCrop",value:function(){this.autoCrop&&this.crop()}},{key:"crop",value:function(){if(this.sourceImage&&this.sourceImage.nativeElement&&null!=this.transformedImage){this.startCropImage.emit();var t=this.getImagePosition(),e=t.x2-t.x1,i=t.y2-t.y1,a=document.createElement("canvas");a.width=e,a.height=i;var o=a.getContext("2d");if(o){null!=this.backgroundColor&&(o.fillStyle=this.backgroundColor,o.fillRect(0,0,e,i));var n=(this.transform.scale||1)*(this.transform.flipH?-1:1),c=(this.transform.scale||1)*(this.transform.flipV?-1:1);o.setTransform(n,0,0,c,this.transformedSize.width/2,this.transformedSize.height/2),o.translate(-t.x1/n,-t.y1/c),o.rotate((this.transform.rotate||0)*Math.PI/180),o.drawImage(this.transformedImage,-this.transformedSize.width/2,-this.transformedSize.height/2);var r={width:e,height:i,imagePosition:t,cropperPosition:Object.assign({},this.cropper)};this.containWithinAspectRatio&&(r.offsetImagePosition=this.getOffsetImagePosition());var s=this.getResizeRatio(e,i);return 1!==s&&(r.width=Math.round(e*s),r.height=this.maintainAspectRatio?Math.round(r.width/this.aspectRatio):Math.round(i*s),function(t,e,i){var a=t.width,o=t.height,n=a/(e=Math.round(e)),c=o/(i=Math.round(i)),r=Math.ceil(n/2),s=Math.ceil(c/2),l=t.getContext("2d");if(l){for(var u=l.getImageData(0,0,a,o),p=l.createImageData(e,i),h=u.data,d=p.data,m=0;m<i;m++)for(var f=0;f<e;f++){var g=4*(f+m*e),b=m*c,v=0,y=0,x=0,C=0,k=0,w=0,S=0,A=Math.floor(f*n),_=Math.floor(m*c),P=Math.ceil((f+1)*n),I=Math.ceil((m+1)*c);P=Math.min(P,a),I=Math.min(I,o);for(var M=_;M<I;M++)for(var O=Math.abs(b-M)/s,G=f*n,R=O*O,F=A;F<P;F++){var z=Math.abs(G-F)/r,E=Math.sqrt(R+z*z);if(!(E>=1)){var U=4*(F+M*a);S+=(v=2*E*E*E-3*E*E+1)*h[U+3],x+=v,h[U+3]<255&&(v=v*h[U+3]/250),C+=v*h[U],k+=v*h[U+1],w+=v*h[U+2],y+=v}}d[g]=C/y,d[g+1]=k/y,d[g+2]=w/y,d[g+3]=S/x}t.width=e,t.height=i,l.putImageData(p,0,0)}}(a,r.width,r.height)),r.base64=this.cropToBase64(a),this.imageCropped.emit(r),r}}return null}},{key:"getImagePosition",value:function(){var t=this.transformedSize.width/this.sourceImage.nativeElement.offsetWidth,e={x1:Math.round(this.cropper.x1*t),y1:Math.round(this.cropper.y1*t),x2:Math.round(this.cropper.x2*t),y2:Math.round(this.cropper.y2*t)};return this.containWithinAspectRatio||(e.x1=Math.max(e.x1,0),e.y1=Math.max(e.y1,0),e.x2=Math.min(e.x2,this.transformedSize.width),e.y2=Math.min(e.y2,this.transformedSize.height)),e}},{key:"getOffsetImagePosition",value:function(){var t,e,i=this.transformedSize.width/this.sourceImage.nativeElement.offsetWidth;(this.canvasRotation+this.exifTransform.rotate)%2?(t=(this.transformedSize.width-this.originalSize.height)/2,e=(this.transformedSize.height-this.originalSize.width)/2):(t=(this.transformedSize.width-this.originalSize.width)/2,e=(this.transformedSize.height-this.originalSize.height)/2);var a={x1:Math.round(this.cropper.x1*i)-t,y1:Math.round(this.cropper.y1*i)-e,x2:Math.round(this.cropper.x2*i)-t,y2:Math.round(this.cropper.y2*i)-e};return this.containWithinAspectRatio||(a.x1=Math.max(a.x1,0),a.y1=Math.max(a.y1,0),a.x2=Math.min(a.x2,this.transformedSize.width),a.y2=Math.min(a.y2,this.transformedSize.height)),a}},{key:"cropToBase64",value:function(t){return t.toDataURL("image/"+this.format,this.getQuality())}},{key:"getQuality",value:function(){return Math.min(1,Math.max(0,this.imageQuality/100))}},{key:"getResizeRatio",value:function(t,e){var i=this.resizeToWidth/t,a=this.resizeToHeight/e,o=new Array;this.resizeToWidth>0&&o.push(i),this.resizeToHeight>0&&o.push(a);var n=0===o.length?1:Math.min.apply(Math,o);return n>1&&!this.onlyScaleDown?n:Math.min(n,1)}},{key:"getClientX",value:function(t){return(t.touches&&t.touches[0]?t.touches[0].clientX:t.clientX)||0}},{key:"getClientY",value:function(t){return(t.touches&&t.touches[0]?t.touches[0].clientY:t.clientY)||0}}]),t}()).\u0275fac=function(t){return new(t||bt)(r.Vb(ut.b),r.Vb(r.h))},bt.\u0275cmp=r.Pb({type:bt,selectors:[["image-cropper"]],viewQuery:function(t,e){var i;1&t&&(r.Lc(pt,!0),r.Uc(ht,!0)),2&t&&(r.Bc(i=r.kc())&&(e.wrapper=i.first),r.Bc(i=r.kc())&&(e.sourceImage=i.first))},hostVars:4,hostBindings:function(t,e){1&t&&r.jc("resize",(function(t){return e.onResize()}),!1,r.Fc)("mousemove",(function(t){return e.moveImg(t)}),!1,r.Ec)("touchmove",(function(t){return e.moveImg(t)}),!1,r.Ec)("mouseup",(function(t){return e.moveStop()}),!1,r.Ec)("touchend",(function(t){return e.moveStop()}),!1,r.Ec),2&t&&(r.Mc("text-align",e.alignImage),r.Lb("disabled",e.disabled))},inputs:{format:"format",maintainAspectRatio:"maintainAspectRatio",transform:"transform",aspectRatio:"aspectRatio",resizeToWidth:"resizeToWidth",resizeToHeight:"resizeToHeight",cropperMinWidth:"cropperMinWidth",cropperMinHeight:"cropperMinHeight",cropperStaticWidth:"cropperStaticWidth",cropperStaticHeight:"cropperStaticHeight",canvasRotation:"canvasRotation",initialStepSize:"initialStepSize",roundCropper:"roundCropper",onlyScaleDown:"onlyScaleDown",imageQuality:"imageQuality",autoCrop:"autoCrop",containWithinAspectRatio:"containWithinAspectRatio",hideResizeSquares:"hideResizeSquares",cropper:"cropper",alignImage:"alignImage",disabled:"disabled",imageChangedEvent:"imageChangedEvent",imageURL:"imageURL",imageBase64:"imageBase64",imageFile:"imageFile",backgroundColor:"backgroundColor"},outputs:{imageCropped:"imageCropped",startCropImage:"startCropImage",imageLoaded:"imageLoaded",cropperReady:"cropperReady",loadImageFailed:"loadImageFailed"},features:[r.Eb()],decls:5,vars:10,consts:[["wrapper",""],["class","source-image",3,"src","visibility","transform","load",4,"ngIf"],[1,"overlay"],["class","cropper","tabindex","0",3,"rounded","top","left","width","height","margin-left","visibility","keydown",4,"ngIf"],[1,"source-image",3,"src","load"],["sourceImage",""],["tabindex","0",1,"cropper",3,"keydown"],[1,"move",3,"mousedown","touchstart"],[4,"ngIf"],[1,"resize","topleft",3,"mousedown","touchstart"],[1,"square"],[1,"resize","top"],[1,"resize","topright",3,"mousedown","touchstart"],[1,"resize","right"],[1,"resize","bottomright",3,"mousedown","touchstart"],[1,"resize","bottom"],[1,"resize","bottomleft",3,"mousedown","touchstart"],[1,"resize","left"],[1,"resize-bar","top",3,"mousedown","touchstart"],[1,"resize-bar","right",3,"mousedown","touchstart"],[1,"resize-bar","bottom",3,"mousedown","touchstart"],[1,"resize-bar","left",3,"mousedown","touchstart"]],template:function(t,e){1&t&&(r.bc(0,"div",null,0),r.Nc(2,dt,2,5,"img",1),r.Wb(3,"div",2),r.Nc(4,ft,3,15,"div",3),r.ac()),2&t&&(r.Mc("background",e.imageVisible&&e.backgroundColor,r.Ob),r.Gb(2),r.sc("ngIf",e.safeImgDataUrl),r.Gb(1),r.Mc("width",e.maxSize.width,"px")("height",e.maxSize.height,"px")("margin-left","center"===e.alignImage?e.marginLeft:null),r.Gb(1),r.sc("ngIf",e.imageVisible))},directives:[a.l],styles:['[_nghost-%COMP%]{display:flex;position:relative;width:100%;max-width:100%;max-height:100%;overflow:hidden;padding:5px;text-align:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:100%;position:relative}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.source-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;transform-origin:center}[_nghost-%COMP%]   .overlay[_ngcontent-%COMP%]{position:absolute;pointer-events:none;touch-action:none;outline:var(--cropper-overlay-color,#fff) solid 100vw;top:0;left:0}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]{position:absolute;display:flex;color:#53535c;background:0 0;outline:rgba(255,255,255,.3) solid 100vw;outline:var(--cropper-outline-color,rgba(255,255,255,.3)) solid 100vw;touch-action:none}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]:after{position:absolute;content:"";top:0;bottom:0;left:0;right:0;pointer-events:none;border:1px dashed;opacity:.75;color:inherit;z-index:1}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .move[_ngcontent-%COMP%]{width:100%;cursor:move;border:1px solid rgba(255,255,255,.5)}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]:focus   .move[_ngcontent-%COMP%]{border-color:#1e90ff;border-width:2px}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize[_ngcontent-%COMP%]{position:absolute;display:inline-block;line-height:6px;padding:8px;opacity:.85;z-index:1}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize[_ngcontent-%COMP%]   .square[_ngcontent-%COMP%]{display:inline-block;background:#53535c;width:6px;height:6px;border:1px solid rgba(255,255,255,.5);box-sizing:content-box}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.topleft[_ngcontent-%COMP%]{top:-12px;left:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.top[_ngcontent-%COMP%]{top:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.topright[_ngcontent-%COMP%]{top:-12px;right:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.right[_ngcontent-%COMP%]{top:calc(50% - 12px);right:-12px;cursor:ew-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.bottomright[_ngcontent-%COMP%]{bottom:-12px;right:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.bottom[_ngcontent-%COMP%]{bottom:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.bottomleft[_ngcontent-%COMP%]{bottom:-12px;left:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.left[_ngcontent-%COMP%]{top:calc(50% - 12px);left:-12px;cursor:ew-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar[_ngcontent-%COMP%]{position:absolute;z-index:1}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar.top[_ngcontent-%COMP%]{top:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar.right[_ngcontent-%COMP%]{top:11px;right:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar.bottom[_ngcontent-%COMP%]{bottom:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar.left[_ngcontent-%COMP%]{top:11px;left:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .cropper.rounded[_ngcontent-%COMP%]{outline-color:transparent}[_nghost-%COMP%]   .cropper.rounded[_ngcontent-%COMP%]:after{border-radius:100%;box-shadow:0 0 0 100vw rgba(255,255,255,.3);box-shadow:0 0 0 100vw var(--cropper-outline-color,rgba(255,255,255,.3))}@media (orientation:portrait){[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]{outline-width:100vh}[_nghost-%COMP%]   .cropper.rounded[_ngcontent-%COMP%]:after{box-shadow:0 0 0 100vh rgba(255,255,255,.3);box-shadow:0 0 0 100vh var(--cropper-outline-color,rgba(255,255,255,.3))}}[_nghost-%COMP%]   .cropper.rounded[_ngcontent-%COMP%]   .move[_ngcontent-%COMP%]{border-radius:100%}.disabled[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .move[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar[_ngcontent-%COMP%]{display:none}'],changeDetection:0}),bt),xt=((gt=function t(){_classCallCheck(this,t)}).\u0275mod=r.Tb({type:gt}),gt.\u0275inj=r.Sb({factory:function(t){return new(t||gt)},imports:[[a.c]]}),gt),Ct=i("bv9b");function kt(t,e){if(1&t&&r.Wb(0,"img",20),2&t){var i=r.nc(3);r.sc("src",i.categoreyImage,r.Ic)}}function wt(t,e){if(1&t){var i=r.cc();r.bc(0,"div",15),r.bc(1,"div",16),r.bc(2,"label",17),r.Pc(3),r.ac(),r.bc(4,"input",18),r.jc("change",(function(t){return r.Gc(i),r.nc(2).fileChangeEvent(t)})),r.ac(),r.ac(),r.Nc(5,kt,1,1,"img",19),r.ac()}if(2&t){var a=r.nc(2);r.Gb(3),r.Qc(a.categoreyImage?"Change Image":"Upload Image"),r.Gb(2),r.sc("ngIf",a.categoreyImage)}}function St(t,e){1&t&&(r.bc(0,"p",21),r.Pc(1," *Please fill all the fields "),r.ac())}function At(t,e){if(1&t){var i=r.cc();r.bc(0,"form",3),r.jc("ngSubmit",(function(t){return r.Gc(i),r.nc().submit()})),r.bc(1,"div",4),r.bc(2,"div",5),r.bc(3,"mat-form-field",6),r.Wb(4,"input",7),r.ac(),r.ac(),r.bc(5,"div",5),r.bc(6,"mat-form-field",6),r.Wb(7,"input",8),r.ac(),r.ac(),r.Nc(8,wt,6,2,"div",9),r.Nc(9,St,2,0,"p",10),r.bc(10,"div",11),r.bc(11,"button",12),r.Pc(12),r.oc(13,"translate"),r.ac(),r.Wb(14,"span",13),r.bc(15,"button",14),r.jc("click",(function(t){return r.Gc(i),r.nc().dialogRef.close(!1)})),r.Pc(16," Cancel "),r.ac(),r.ac(),r.ac(),r.ac()}if(2&t){var a=r.nc();r.sc("formGroup",a.itemForm),r.Gb(8),r.sc("ngIf",!(null!=a.data&&a.data.isNew)),r.Gb(1),r.sc("ngIf",a.validationErrors),r.Gb(2),r.sc("disabled",a.itemForm.invalid),r.Gb(1),r.Rc(" ",r.pc(13,5,"SAVE")," ")}}function _t(t,e){1&t&&r.Wb(0,"mat-progress-bar",32)}function Pt(t,e){if(1&t&&(r.bc(0,"div"),r.Pc(1," Uploading "),r.Nc(2,_t,1,0,"mat-progress-bar",31),r.ac()),2&t){var i=r.nc(2);r.Gb(2),r.sc("ngIf",i.loader)}}function It(t,e){if(1&t){var i=r.cc();r.bc(0,"div",22),r.bc(1,"div",23),r.bc(2,"div"),r.bc(3,"image-cropper",24),r.jc("imageCropped",(function(t){return r.Gc(i),r.nc().imageCropped(t)}))("imageLoaded",(function(t){return r.Gc(i),r.nc().imageLoaded()}))("cropperReady",(function(t){return r.Gc(i),r.nc().cropperReady()}))("loadImageFailed",(function(t){return r.Gc(i),r.nc().loadImageFailed()})),r.ac(),r.ac(),r.bc(4,"div"),r.bc(5,"div",25),r.bc(6,"div",26),r.Wb(7,"img",27),r.ac(),r.bc(8,"p",28),r.Pc(9,"Preview"),r.ac(),r.ac(),r.ac(),r.ac(),r.Nc(10,Pt,3,1,"div",29),r.bc(11,"div",11),r.bc(12,"button",30),r.jc("click",(function(t){return r.Gc(i),r.nc().fileUpload()})),r.Pc(13," Upload "),r.ac(),r.Wb(14,"span",13),r.bc(15,"button",14),r.jc("click",(function(t){return r.Gc(i),r.nc().cancelFileUpload()})),r.Pc(16," Cancel "),r.ac(),r.ac(),r.ac()}if(2&t){var a=r.nc();r.Gb(3),r.sc("imageChangedEvent",a.imageChangedEvent)("maintainAspectRatio",!0)("aspectRatio",1)("resizeToWidth",350)("cropperMinWidth",1e3),r.Gb(4),r.sc("src",a.croppedImage,r.Ic),r.Gb(3),r.sc("ngIf",a.loader)}}var Mt,Ot,Gt=((Ot=function(){function t(e,i,a,o,n){_classCallCheck(this,t),this.data=e,this.dialogRef=i,this.fb=a,this.productApiService=o,this.appLoaderService=n,this.imageChangedEvent="",this.croppedImage="",this.loader=!1,this.subscripition=new k.a}return _createClass(t,[{key:"ngOnInit",value:function(){this.buildItemForm(this.data.payload),this.categoreyImage=this.data.payload.image}},{key:"buildItemForm",value:function(t){this.itemForm=this.fb.group({name:[t.name||"",n.t.required],code:[t.code||"",n.t.required]})}},{key:"submit",value:function(){this.itemForm.value.name=this.itemForm.value.name.trim(),this.itemForm.value.code=this.itemForm.value.code.trim(),this.itemForm.value.code.length>0&&this.itemForm.value.name.length>0?this.dialogRef.close(this.itemForm.value):this.validationErrors=!0}},{key:"imageCropped",value:function(t){this.croppedImage=t.base64}},{key:"fileChangeEvent",value:function(t){this.appLoaderService.open(),this.fileSelected=!0,this.fileName=t.srcElement.files[0].name,this.imageChangedEvent=t}},{key:"b64toBlob",value:function(t){for(var e=atob(t.split(",")[1]),i=new ArrayBuffer(e.length),a=new Uint8Array(i),o=0;o<e.length;o++)a[o]=e.charCodeAt(o);return new Blob([i],{type:"image/png"})}},{key:"fileUpload",value:function(){var t=this;this.loader=!0;var e=this.b64toBlob(this.croppedImage),i=new FormData;i.append("file",e,this.fileName),this.productApiService.imageUpload(this.data.payload._id,i).subscribe((function(e){"success"===e.status&&(t.fileSelected=!1,t.loader=!1,t.categoreyImage=t.croppedImage)}),(function(e){t.loader=!1}))}},{key:"imageLoaded",value:function(){}},{key:"cropperReady",value:function(){this.appLoaderService.close()}},{key:"loadImageFailed",value:function(){}},{key:"cancelFileUpload",value:function(){this.fileSelected=!1}},{key:"ngOnDestroy",value:function(){this.subscripition.unsubscribe()}}]),t}()).\u0275fac=function(t){return new(t||Ot)(r.Vb(c.a),r.Vb(c.f),r.Vb(n.c),r.Vb(lt),r.Vb(g.a))},Ot.\u0275cmp=r.Pb({type:Ot,selectors:[["app-category-popup"]],decls:4,vars:3,consts:[["matDialogTitle",""],[3,"formGroup","ngSubmit",4,"ngIf"],["fxLayout","row wrap",4,"ngIf"],[3,"formGroup","ngSubmit"],["fxLayout","row wrap","fxLayout.lt-sm","column"],["fxFlex","50",1,"pr-1"],[1,"full-width","p-b-10"],["matInput","","name","username","formControlName","name","placeholder","Category"],["matInput","","name","username","formControlName","code","placeholder","Category Code"],["fxFlex","50","class","pr-1 image-view-section",4,"ngIf"],["class","error-msg",4,"ngIf"],["fxFlex","100",1,"footer-buttons"],["mat-raised-button","","color","primary",3,"disabled"],["fxFlex",""],["mat-button","","color","warn","type","button",3,"click"],["fxFlex","50",1,"pr-1","image-view-section"],[1,"p-t-15"],["for","d",1,"_upload_label"],["id","d","type","file",2,"display","none",3,"change"],["class","uploaded-image","alt","Category Image",3,"src",4,"ngIf"],["alt","Category Image",1,"uploaded-image",3,"src"],[1,"error-msg"],["fxLayout","row wrap"],[1,"image-section"],["format","png",3,"imageChangedEvent","maintainAspectRatio","aspectRatio","resizeToWidth","cropperMinWidth","imageCropped","imageLoaded","cropperReady","loadImageFailed"],[1,"preview"],[2,"max-width","45%","width","100%","margin","auto"],[3,"src"],[1,"text-center"],[4,"ngIf"],["mat-raised-button","","color","primary",3,"click"],["mode","indeterminate",4,"ngIf"],["mode","indeterminate"]],template:function(t,e){1&t&&(r.bc(0,"h1",0),r.Pc(1),r.ac(),r.Nc(2,At,17,7,"form",1),r.Nc(3,It,17,7,"div",2)),2&t&&(r.Gb(1),r.Qc(e.fileSelected?"Upload Image":e.data.title),r.Gb(1),r.sc("ngIf",!e.fileSelected),r.Gb(1),r.sc("ngIf",e.fileSelected))},directives:[c.g,a.l,n.u,n.o,n.h,s.b,l.b,n.b,n.n,n.f,u.b,yt,Ct.a],pipes:[p.c],styles:["._upload_label[_ngcontent-%COMP%]{padding:8px 5px;color:#212121;background:rgba(103,100,139,.1);border:2px dotted #949494;border-radius:5px;text-transform:capitalize}.error-msg[_ngcontent-%COMP%]{color:red}.footer-buttons[_ngcontent-%COMP%]{margin-top:40px}.p-t-15[_ngcontent-%COMP%]{padding-top:15px}.image-section[_ngcontent-%COMP%]{overflow-y:auto;overflow-x:hidden;height:320px}.image-view-section[_ngcontent-%COMP%]{display:flex}.uploaded-image[_ngcontent-%COMP%]{width:200px;height:auto;max-width:300px;border:3px solid hsla(0,0%,89%,.4);border-radius:7px;margin-left:10px}"]}),Ot),Rt=((Mt=function(){function t(e,i){_classCallCheck(this,t),this.data=e,this.dialogRef=i}return _createClass(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||Mt)(r.Vb(c.a),r.Vb(c.f))},Mt.\u0275cmp=r.Pb({type:Mt,selectors:[["app-image-viewer"]],decls:8,vars:2,consts:[[1,"m"],[1,"m-header"],[1,"m-close-x",3,"click"],["matDialogTitle","",1,"m-header-h1"],[1,"m-body"],["alt","image viewer",1,"m-image",3,"src"]],template:function(t,e){1&t&&(r.bc(0,"div",0),r.bc(1,"div",1),r.bc(2,"div",2),r.jc("click",(function(t){return e.dialogRef.close(!1)})),r.Pc(3,"x"),r.ac(),r.bc(4,"h1",3),r.Pc(5),r.ac(),r.ac(),r.bc(6,"div",4),r.Wb(7,"img",5),r.ac(),r.ac()),2&t&&(r.Gb(5),r.Qc(e.data.title),r.Gb(2),r.sc("src",e.data.imageUrl,r.Ic))},directives:[c.g],styles:[".m-body[_ngcontent-%COMP%]{text-align:center;margin:auto auto 10px}.m-header-h1[_ngcontent-%COMP%]{padding:2px 9px}.m-close-x[_ngcontent-%COMP%]{position:absolute;right:8px;cursor:pointer;padding:0 6px;font-size:24px}.m-header[_ngcontent-%COMP%]{position:relative}.m-image[_ngcontent-%COMP%]{padding:0 20px}"]}),Mt);function Ft(t,e){if(1&t&&r.Pc(0),2&t){var i=e.row;r.Rc(" ",null==i?null:i.name," ")}}function zt(t,e){if(1&t&&r.Pc(0),2&t){var i=e.row;r.Rc(" ",null==i?null:i.code," ")}}function Et(t,e){if(1&t){var i=r.cc();r.bc(0,"div",11),r.jc("click",(function(t){r.Gc(i);var e=r.nc().row;return r.nc().openImageViewer(e)})),r.Wb(1,"img",12),r.ac()}if(2&t){var a=r.nc().row;r.Gb(1),r.sc("src",null==a?null:a.image,r.Ic)}}function Ut(t,e){if(1&t&&r.Nc(0,Et,2,1,"div",10),2&t){var i=e.row;r.sc("ngIf",void 0!==(null==i?null:i.image))}}function Dt(t,e){if(1&t){var i=r.cc();r.bc(0,"mat-slide-toggle",13),r.jc("change",(function(t){r.Gc(i);var a=e.row;return r.nc().statusChange(a,t)})),r.ac()}if(2&t){var a=e.row;r.sc("checked","active"===(null==a?null:a.status))}}function Tt(t,e){if(1&t){var i=r.cc();r.bc(0,"button",14),r.jc("click",(function(t){r.Gc(i);var a=e.row;return r.nc().openPopUp(a)})),r.bc(1,"mat-icon"),r.Pc(2,"edit"),r.ac(),r.ac(),r.bc(3,"button",15),r.jc("click",(function(t){r.Gc(i);var a=e.row;return r.nc().deleteItem(a)})),r.bc(4,"mat-icon"),r.Pc(5,"delete"),r.ac(),r.ac()}}var Vt,jt=((Vt=function(){function t(e,i,a,o,n){_classCallCheck(this,t),this.dialog=e,this.snack=i,this.productApiService=a,this.confirmServive=o,this.loader=n,this.Categorys=[],this.subscripition=new k.a}return _createClass(t,[{key:"ngOnInit",value:function(){this.loader.open(),this.getCategorys()}},{key:"getCategorys",value:function(){var t=this;this.subscripition.add(this.productApiService.getCategorys().subscribe((function(e){t.Categorys=_toConsumableArray(e.result),t.loader.close()}),(function(e){t.loader.close()})))}},{key:"openPopUp",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;this.dialog.open(Gt,{width:"520px",disableClose:!0,data:{title:i?"Add New Category":"Update Category",payload:e,isNew:i}}).afterClosed().subscribe((function(a){a?(t.loader.open(),t.subscripition.add(i?t.productApiService.addCategory(a).subscribe((function(e){t.loader.close(),"success"===e.status&&(t.Categorys.push(e.result),t.Categorys=_toConsumableArray(t.Categorys),t.snack.open("Category Added!","OK",{duration:4e3}))}),(function(e){t.loader.close()})):t.productApiService.updateCategory(e._id,a).subscribe((function(i){t.loader.close(),"success"===i.status&&(t.getCategory(e._id,"update"),t.snack.open("Category Updated!","OK",{duration:4e3}))}),(function(e){t.loader.close()})))):i||t.getCategory(e._id,"update")}))}},{key:"getCategory",value:function(t,e){var i=this;this.subscripition.add(this.productApiService.getCategory(t).subscribe((function(t){"update"===e&&i.Categorys.forEach((function(e,a){e._id===t.result._id&&(i.Categorys[a]=t.result,i.Categorys=_toConsumableArray(i.Categorys))}))}),(function(t){i.loader.close()})))}},{key:"deleteItem",value:function(t){var e=this;this.subscripition.add(this.confirmServive.confirm({message:"Delete ".concat(t.name,"?")}).subscribe((function(i){i&&(e.loader.open(),e.Categorys.forEach((function(i,a){i._id===t._id&&e.Categorys.splice(a,1)})),e.Categorys=_toConsumableArray(e.Categorys),e.productApiService.deleteCategory(t._id).subscribe((function(t){e.loader.close(),"success"===t.status&&e.snack.open("Category deleted!","OK",{duration:4e3})}),(function(t){e.loader.close()})))})))}},{key:"statusChange",value:function(t,e){var i=this;this.loader.open(),this.subscripition.add(this.productApiService.updateCategory(t._id,{status:e.checked?"active":"inactive"}).subscribe((function(e){i.loader.close(),"success"===e.status&&(i.getCategory(t._id,"update"),i.snack.open("Status Updated!","OK",{duration:4e3}))}),(function(t){i.loader.close()})))}},{key:"openImageViewer",value:function(t){this.dialog.open(Rt,{width:"auto",disableClose:!0,data:{title:t.name,imageUrl:t.image},panelClass:"modal-image-viewer"}).afterClosed().subscribe((function(t){}))}},{key:"ngOnDestroy",value:function(){this.loader.close(),this.subscripition.unsubscribe()}}]),t}()).\u0275fac=function(t){return new(t||Vt)(r.Vb(c.b),r.Vb(w.a),r.Vb(lt),r.Vb(C.a),r.Vb(g.a))},Vt.\u0275cmp=r.Pb({type:Vt,selectors:[["app-category"]],decls:18,vars:17,consts:[[1,"m-333"],["mat-raised-button","","color","primary",1,"mb-05",3,"click"],[1,"p-0"],[1,"material","ml-0","mr-0",3,"rows","columnMode","headerHeight","footerHeight","limit","rowHeight"],["name","Category",3,"flexGrow"],["ngx-datatable-cell-template",""],["name","Category Code",3,"flexGrow"],["name","Image",3,"flexGrow"],["name","Active",3,"flexGrow"],["name","Actions",3,"flexGrow"],["class","_img_div",3,"click",4,"ngIf"],[1,"_img_div",3,"click"],["title","View",1,"_img",3,"src"],[3,"checked","change"],["mat-icon-button","","mat-sm-button","","color","primary",1,"mr-1",3,"click"],["mat-icon-button","","mat-sm-button","","color","warn",3,"click"]],template:function(t,e){1&t&&(r.bc(0,"div",0),r.bc(1,"button",1),r.jc("click",(function(t){return e.openPopUp({},!0)})),r.Pc(2),r.oc(3,"translate"),r.oc(4,"translate"),r.ac(),r.ac(),r.bc(5,"mat-card",2),r.bc(6,"mat-card-content",2),r.bc(7,"ngx-datatable",3),r.bc(8,"ngx-datatable-column",4),r.Nc(9,Ft,1,1,"ng-template",5),r.ac(),r.bc(10,"ngx-datatable-column",6),r.Nc(11,zt,1,1,"ng-template",5),r.ac(),r.bc(12,"ngx-datatable-column",7),r.Nc(13,Ut,1,1,"ng-template",5),r.ac(),r.bc(14,"ngx-datatable-column",8),r.Nc(15,Dt,1,1,"ng-template",5),r.ac(),r.bc(16,"ngx-datatable-column",9),r.Nc(17,Tt,6,0,"ng-template",5),r.ac(),r.ac(),r.ac(),r.ac()),2&t&&(r.Gb(2),r.Sc("",r.pc(3,13,"ADD")," ",r.pc(4,15,"Category"),""),r.Gb(5),r.sc("rows",e.Categorys)("columnMode","force")("headerHeight",50)("footerHeight",50)("limit",10)("rowHeight",50),r.Gb(1),r.sc("flexGrow",1),r.Gb(2),r.sc("flexGrow",1),r.Gb(2),r.sc("flexGrow",1),r.Gb(2),r.sc("flexGrow",1),r.Gb(2),r.sc("flexGrow",1))},directives:[u.b,S.a,S.b,A.d,A.b,A.a,a.l,_.a,P.a],pipes:[p.c],styles:["._img_div[_ngcontent-%COMP%]{top:2px;position:absolute;max-width:51px;width:51px;cursor:pointer;padding:0 2px}"]}),Vt),Wt=i("wZkO");function Ht(t,e){if(1&t&&(r.bc(0,"mat-option",17),r.Pc(1),r.ac()),2&t){var i=e.$implicit;r.sc("value",i._id),r.Gb(1),r.Qc(i.name)}}function Nt(t,e){if(1&t&&r.Wb(0,"img",23),2&t){var i=r.nc(3);r.sc("src",i.productImage,r.Ic)}}function Lt(t,e){if(1&t){var i=r.cc();r.bc(0,"div",18),r.bc(1,"div",19),r.bc(2,"label",20),r.Pc(3),r.ac(),r.bc(4,"input",21),r.jc("change",(function(t){return r.Gc(i),r.nc(2).fileChangeEvent(t)})),r.ac(),r.ac(),r.Nc(5,Nt,1,1,"img",22),r.ac()}if(2&t){var a=r.nc(2);r.Gb(3),r.Qc(a.productImage?"Change Image":"Upload Image"),r.Gb(2),r.sc("ngIf",a.productImage)}}function Bt(t,e){1&t&&(r.bc(0,"p",24),r.Pc(1,"*Please fill all the fields"),r.ac())}function Qt(t,e){if(1&t){var i=r.cc();r.bc(0,"form",3),r.jc("ngSubmit",(function(t){return r.Gc(i),r.nc().submit()})),r.bc(1,"div",4),r.bc(2,"div",5),r.bc(3,"mat-form-field",6),r.bc(4,"mat-select",7),r.Nc(5,Ht,2,2,"mat-option",8),r.ac(),r.ac(),r.ac(),r.bc(6,"div",5),r.bc(7,"mat-form-field",6),r.Wb(8,"input",9),r.ac(),r.ac(),r.bc(9,"div",5),r.bc(10,"mat-form-field",6),r.Wb(11,"input",10),r.ac(),r.ac(),r.Nc(12,Lt,6,2,"div",11),r.Nc(13,Bt,2,0,"p",12),r.bc(14,"div",13),r.bc(15,"button",14),r.Pc(16),r.oc(17,"translate"),r.ac(),r.Wb(18,"span",15),r.bc(19,"button",16),r.jc("click",(function(t){return r.Gc(i),r.nc().dialogRef.close(!1)})),r.Pc(20,"Cancel"),r.ac(),r.ac(),r.ac(),r.ac()}if(2&t){var a=r.nc();r.sc("formGroup",a.itemForm),r.Gb(5),r.sc("ngForOf",a.categories),r.Gb(7),r.sc("ngIf",!(null!=a.data&&a.data.isNew)),r.Gb(1),r.sc("ngIf",a.validationErrors),r.Gb(2),r.sc("disabled",a.itemForm.invalid),r.Gb(1),r.Qc(r.pc(17,6,"SAVE"))}}function Kt(t,e){1&t&&r.Wb(0,"mat-progress-bar",36)}function qt(t,e){if(1&t&&(r.bc(0,"div"),r.Pc(1," Uploading "),r.Nc(2,Kt,1,0,"mat-progress-bar",35),r.ac()),2&t){var i=r.nc(2);r.Gb(2),r.sc("ngIf",i.loader)}}function Xt(t,e){if(1&t){var i=r.cc();r.bc(0,"div",25),r.bc(1,"div",26),r.bc(2,"div"),r.bc(3,"image-cropper",27),r.jc("imageCropped",(function(t){return r.Gc(i),r.nc().imageCropped(t)}))("imageLoaded",(function(t){return r.Gc(i),r.nc().imageLoaded()}))("cropperReady",(function(t){return r.Gc(i),r.nc().cropperReady()}))("loadImageFailed",(function(t){return r.Gc(i),r.nc().loadImageFailed()})),r.ac(),r.ac(),r.bc(4,"div"),r.bc(5,"div",28),r.bc(6,"div",29),r.Wb(7,"img",30),r.ac(),r.bc(8,"p",31),r.Pc(9,"Preview"),r.ac(),r.ac(),r.ac(),r.ac(),r.Nc(10,qt,3,1,"div",32),r.bc(11,"div",33),r.bc(12,"button",34),r.jc("click",(function(t){return r.Gc(i),r.nc().fileUpload()})),r.Pc(13," Upload "),r.ac(),r.Wb(14,"span",15),r.bc(15,"button",16),r.jc("click",(function(t){return r.Gc(i),r.nc().cancelFileUpload()})),r.Pc(16," Cancel "),r.ac(),r.ac(),r.ac()}if(2&t){var a=r.nc();r.Gb(3),r.sc("imageChangedEvent",a.imageChangedEvent)("maintainAspectRatio",!0)("aspectRatio",1)("resizeToWidth",350)("cropperMinWidth",1e3),r.Gb(4),r.sc("src",a.croppedImage,r.Ic),r.Gb(3),r.sc("ngIf",a.fileloader)}}var Yt,$t=((Yt=function(){function t(e,i,a,o,n){_classCallCheck(this,t),this.data=e,this.dialogRef=i,this.fb=a,this.loader=o,this.productApiService=n,this.subscripition=new k.a,this.categories=[],this.imageChangedEvent="",this.croppedImage="",this.fileloader=!1}return _createClass(t,[{key:"ngOnInit",value:function(){this.loader.open(),this.getCategories(),this.buildItemForm(this.data.payload),this.productImage=this.data.payload.image}},{key:"getCategories",value:function(){var t=this;this.subscripition.add(this.productApiService.getCategorys().subscribe((function(e){t.categories=e.result,t.loader.close()}),(function(e){t.loader.close()})))}},{key:"buildItemForm",value:function(t){var e,i;this.itemForm=this.fb.group({category:[(null===(i=null===(e=t)||void 0===e?void 0:e.category)||void 0===i?void 0:i._id)||null,n.t.required],name:[t.name||null,n.t.required],code:[t.code||null,n.t.required]})}},{key:"submit",value:function(){this.itemForm.value.name=this.itemForm.value.name.trim(),this.itemForm.value.code=this.itemForm.value.code.trim(),this.itemForm.value.code.length>0&&this.itemForm.value.name.length>0?this.dialogRef.close(this.itemForm.value):this.validationErrors=!0}},{key:"imageCropped",value:function(t){this.croppedImage=t.base64}},{key:"fileChangeEvent",value:function(t){this.loader.open(),this.fileSelected=!0,this.fileName=t.srcElement.files[0].name,this.imageChangedEvent=t}},{key:"b64toBlob",value:function(t){for(var e=atob(t.split(",")[1]),i=new ArrayBuffer(e.length),a=new Uint8Array(i),o=0;o<e.length;o++)a[o]=e.charCodeAt(o);return new Blob([i],{type:"image/png"})}},{key:"fileUpload",value:function(){var t=this;this.fileloader=!0;var e=this.b64toBlob(this.croppedImage),i=new FormData;i.append("file",e,this.fileName),this.productApiService.productImageUpload(this.data.payload._id,i).subscribe((function(e){"success"===e.status&&(t.fileSelected=!1,t.fileloader=!1,t.productImage=t.croppedImage)}),(function(e){t.fileloader=!1}))}},{key:"imageLoaded",value:function(){}},{key:"cropperReady",value:function(){this.loader.close()}},{key:"loadImageFailed",value:function(){}},{key:"cancelFileUpload",value:function(){this.fileSelected=!1}},{key:"ngOnDestroy",value:function(){this.loader.close(),this.subscripition.unsubscribe()}}]),t}()).\u0275fac=function(t){return new(t||Yt)(r.Vb(c.a),r.Vb(c.f),r.Vb(n.c),r.Vb(g.a),r.Vb(lt))},Yt.\u0275cmp=r.Pb({type:Yt,selectors:[["app-product-popup"]],decls:4,vars:3,consts:[["matDialogTitle",""],[3,"formGroup","ngSubmit",4,"ngIf"],["fxLayout","row wrap",4,"ngIf"],[3,"formGroup","ngSubmit"],["fxLayout","row wrap","fxLayout.lt-sm","column"],["fxFlex","50",1,"pr-1"],[1,"full-width","p-b-10"],["placeholder","Select Category","name","category","formControlName","category",1,"full-width","state-box"],["ngDefaultControl","",3,"value",4,"ngFor","ngForOf"],["matInput","","name","username","formControlName","name","placeholder","Product"],["matInput","","name","username","formControlName","code","placeholder","Product Code"],["fxFlex","50","class","pr-1 image-view-section",4,"ngIf"],["class","error-msg",4,"ngIf"],["fxFlex","100",1,"mt-1"],["mat-raised-button","","color","primary",3,"disabled"],["fxFlex",""],["mat-button","","color","warn","type","button",3,"click"],["ngDefaultControl","",3,"value"],["fxFlex","50",1,"pr-1","image-view-section"],[1,"p-t-15"],["for","d",1,"_upload_label"],["id","d","type","file",2,"display","none",3,"change"],["class","uploaded-image","alt","Category Image",3,"src",4,"ngIf"],["alt","Category Image",1,"uploaded-image",3,"src"],[1,"error-msg"],["fxLayout","row wrap"],[1,"image-section"],["format","png",3,"imageChangedEvent","maintainAspectRatio","aspectRatio","resizeToWidth","cropperMinWidth","imageCropped","imageLoaded","cropperReady","loadImageFailed"],[1,"preview"],[2,"max-width","45%","width","100%","margin","auto"],[3,"src"],[1,"text-center"],[4,"ngIf"],["fxFlex","100",1,"footer-buttons"],["mat-raised-button","","color","primary",3,"click"],["mode","indeterminate",4,"ngIf"],["mode","indeterminate"]],template:function(t,e){1&t&&(r.bc(0,"h1",0),r.Pc(1),r.ac(),r.Nc(2,Qt,21,8,"form",1),r.Nc(3,Xt,17,7,"div",2)),2&t&&(r.Gb(1),r.Qc(e.fileSelected?"Upload Image":e.data.title),r.Gb(1),r.sc("ngIf",!e.fileSelected),r.Gb(1),r.sc("ngIf",e.fileSelected))},directives:[c.g,a.l,n.u,n.o,n.h,s.b,z.a,n.n,n.f,a.k,l.b,n.b,u.b,E.p,yt,Ct.a],pipes:[p.c],styles:["._upload_label[_ngcontent-%COMP%]{padding:8px 5px;color:#212121;background:rgba(103,100,139,.1);border:2px dotted #949494;border-radius:5px;text-transform:capitalize}.error-msg[_ngcontent-%COMP%]{color:red}.footer-buttons[_ngcontent-%COMP%]{margin-top:40px}.p-t-15[_ngcontent-%COMP%]{padding-top:15px}.image-section[_ngcontent-%COMP%]{overflow-y:auto;overflow-x:hidden;height:320px}.image-view-section[_ngcontent-%COMP%]{display:flex}.uploaded-image[_ngcontent-%COMP%]{width:200px;height:auto;max-width:300px;border:3px solid hsla(0,0%,89%,.4);border-radius:7px;margin-left:10px}"]}),Yt);function Jt(t,e){if(1&t&&r.Pc(0),2&t){var i=e.row;r.Rc(" ",null==i?null:i.name," ")}}function Zt(t,e){if(1&t&&r.Pc(0),2&t){var i=e.row;r.Rc(" ",null==i?null:i.code," ")}}function te(t,e){if(1&t){var i=r.cc();r.bc(0,"div",11),r.jc("click",(function(t){r.Gc(i);var e=r.nc().row;return r.nc().openImageViewer(e)})),r.Wb(1,"img",12),r.ac()}if(2&t){var a=r.nc().row;r.Gb(1),r.sc("src",null==a?null:a.image,r.Ic)}}function ee(t,e){if(1&t&&r.Nc(0,te,2,1,"div",10),2&t){var i=e.row;r.sc("ngIf",void 0!==(null==i?null:i.image))}}function ie(t,e){if(1&t){var i=r.cc();r.bc(0,"mat-slide-toggle",13),r.jc("change",(function(t){r.Gc(i);var a=e.row;return r.nc().statusChange(a,t)})),r.ac()}if(2&t){var a=e.row;r.sc("checked","active"===(null==a?null:a.status))}}function ae(t,e){if(1&t){var i=r.cc();r.bc(0,"button",14),r.jc("click",(function(t){r.Gc(i);var a=e.row;return r.nc().openPopUp(a)})),r.bc(1,"mat-icon"),r.Pc(2,"edit"),r.ac(),r.ac(),r.bc(3,"button",15),r.jc("click",(function(t){r.Gc(i);var a=e.row;return r.nc().deleteItem(a)})),r.bc(4,"mat-icon"),r.Pc(5,"delete"),r.ac(),r.ac()}}var oe,ne=((oe=function(){function t(e,i,a,o,n){_classCallCheck(this,t),this.dialog=e,this.snack=i,this.loader=a,this.confirmService=o,this.productApiService=n,this.products=[],this.subscripition=new k.a}return _createClass(t,[{key:"ngOnInit",value:function(){this.loader.open(),this.getAllProducts()}},{key:"getAllProducts",value:function(){var t=this;this.subscripition.add(this.productApiService.getAllProducts().subscribe((function(e){t.products=_toConsumableArray(e.result),t.loader.close()}),(function(e){t.loader.close()})))}},{key:"closeLoader",value:function(){this.loader.close()}},{key:"openPopUp",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;this.dialog.open($t,{width:"520px",disableClose:!0,data:{title:i?"Add New Product":"Update Product",payload:e,isNew:i}}).afterClosed().subscribe((function(a){a?(t.loader.open(),t.subscripition.add(i?t.productApiService.addProduct(a).subscribe((function(e){t.loader.close(),"success"===e.status&&(t.getProduct(e.result._id,"add"),t.snack.open("Product Added!","OK",{duration:4e3}))}),(function(e){t.loader.close()})):t.productApiService.updateProduct(e._id,a).subscribe((function(e){t.loader.close(),"success"===e.status&&(t.getProduct(e.result._id,"update"),t.snack.open("Product Updated!","OK",{duration:4e3}))}),(function(e){t.loader.close()})))):i||t.getProduct(e._id,"update")}))}},{key:"getProduct",value:function(t,e){var i=this;this.subscripition.add(this.productApiService.getProduct(t).subscribe((function(t){"add"===e?(i.products.push(t.result),i.products=_toConsumableArray(i.products)):i.products.forEach((function(e,a){e._id===t.result._id&&(i.products[a]=t.result,i.products=_toConsumableArray(i.products))}))}),(function(t){i.loader.close()})))}},{key:"deleteItem",value:function(t){var e=this;this.subscripition.add(this.confirmService.confirm({message:"Delete ".concat(t.name,"?")}).subscribe((function(i){i&&(e.loader.open(),e.products.forEach((function(i,a){i._id===t._id&&e.products.splice(a,1)})),e.products=_toConsumableArray(e.products),e.productApiService.deleteProduct(t._id).subscribe((function(t){e.loader.close(),"success"===t.status&&e.snack.open("Product deleted!","OK",{duration:4e3})})))}),(function(t){e.loader.close()})))}},{key:"statusChange",value:function(t,e){var i=this;this.loader.open(),this.subscripition.add(this.productApiService.updateProduct(t._id,{status:e.checked?"active":"inactive"}).subscribe((function(e){i.loader.close(),"success"===e.status&&(i.getProduct(t._id,"update"),i.snack.open("Status Updated!","OK",{duration:4e3}))}),(function(t){i.loader.close()})))}},{key:"openImageViewer",value:function(t){this.dialog.open(Rt,{width:"auto",disableClose:!0,data:{title:t.name,imageUrl:t.image},panelClass:"modal-image-viewer"}).afterClosed().subscribe((function(t){}))}},{key:"ngOnDestroy",value:function(){this.subscripition.unsubscribe()}}]),t}()).\u0275fac=function(t){return new(t||oe)(r.Vb(c.b),r.Vb(w.a),r.Vb(g.a),r.Vb(C.a),r.Vb(lt))},oe.\u0275cmp=r.Pb({type:oe,selectors:[["app-product"]],decls:18,vars:18,consts:[[1,"m-333"],["mat-raised-button","","color","primary",1,"mb-05",3,"click"],[1,"p-0"],[1,"material","ml-0","mr-0",3,"rows","columnMode","headerHeight","footerHeight","scrollbarH","limit","rowHeight"],["name","Name",3,"flexGrow"],["ngx-datatable-cell-template",""],["name","Product Code",3,"flexGrow"],["name","Image",3,"flexGrow"],["name","Active",3,"flexGrow"],["name","Actions",3,"flexGrow"],["class","_img_div",3,"click",4,"ngIf"],[1,"_img_div",3,"click"],["title","View",1,"_img",3,"src"],[3,"checked","change"],["mat-icon-button","","mat-sm-button","","color","primary",1,"mr-1",3,"click"],["mat-icon-button","","mat-sm-button","","color","warn",3,"click"]],template:function(t,e){1&t&&(r.bc(0,"div",0),r.bc(1,"button",1),r.jc("click",(function(t){return e.openPopUp({},!0)})),r.Pc(2),r.oc(3,"translate"),r.oc(4,"translate"),r.ac(),r.ac(),r.bc(5,"mat-card",2),r.bc(6,"mat-card-content",2),r.bc(7,"ngx-datatable",3),r.bc(8,"ngx-datatable-column",4),r.Nc(9,Jt,1,1,"ng-template",5),r.ac(),r.bc(10,"ngx-datatable-column",6),r.Nc(11,Zt,1,1,"ng-template",5),r.ac(),r.bc(12,"ngx-datatable-column",7),r.Nc(13,ee,1,1,"ng-template",5),r.ac(),r.bc(14,"ngx-datatable-column",8),r.Nc(15,ie,1,1,"ng-template",5),r.ac(),r.bc(16,"ngx-datatable-column",9),r.Nc(17,ae,6,0,"ng-template",5),r.ac(),r.ac(),r.ac(),r.ac()),2&t&&(r.Gb(2),r.Sc(" ",r.pc(3,14,"ADD")," ",r.pc(4,16,"Product")," "),r.Gb(5),r.sc("rows",e.products)("columnMode","force")("headerHeight",50)("footerHeight",50)("scrollbarH",!0)("limit",10)("rowHeight",50),r.Gb(1),r.sc("flexGrow",1),r.Gb(2),r.sc("flexGrow",1),r.Gb(2),r.sc("flexGrow",1),r.Gb(2),r.sc("flexGrow",1),r.Gb(2),r.sc("flexGrow",1))},directives:[u.b,S.a,S.b,A.d,A.b,A.a,a.l,_.a,P.a],pipes:[p.c],styles:["._img_div[_ngcontent-%COMP%]{top:2px;position:absolute;max-width:51px;width:51px;cursor:pointer;padding:0 2px}"]}),oe);function ce(t,e){1&t&&(r.bc(0,"p",16),r.Pc(1,"*Please fill all the fields"),r.ac())}var re,se=((re=function(){function t(e,i,a,o,n){_classCallCheck(this,t),this.data=e,this.dialogRef=i,this.fb=a,this.loader=o,this.productApiService=n,this.subscripition=new k.a,this.categories=[],this.format="integer"}return _createClass(t,[{key:"ngOnInit",value:function(){this.buildAttributeForm(this.data.payload)}},{key:"buildAttributeForm",value:function(t){this.format=t.format?t.format:"integer",this.itemForm=this.fb.group({name:[t.name||null,n.t.required],length:[t.length||null,n.t.required],format:[null]})}},{key:"submit",value:function(){this.itemForm.value.format=this.format,this.itemForm.value.name=this.itemForm.value.name.trim(),console.log(this.itemForm.value),this.itemForm.value.name.length>0?this.dialogRef.close(this.itemForm.value):this.validationErrors=!0}},{key:"ngOnDestroy",value:function(){this.loader.close(),this.subscripition.unsubscribe()}}]),t}()).\u0275fac=function(t){return new(t||re)(r.Vb(c.a),r.Vb(c.f),r.Vb(n.c),r.Vb(g.a),r.Vb(lt))},re.\u0275cmp=r.Pb({type:re,selectors:[["app-attributes-popup"]],decls:29,vars:8,consts:[["matDialogTitle",""],[3,"formGroup","ngSubmit"],["fxLayout","row wrap","fxLayout.lt-sm","column"],["fxFlex","50",1,"pr-1"],[1,"full-width","p-b-10"],["matInput","","name","name","formControlName","name","placeholder","Name"],[3,"value","valueChange"],["value","integer"],["value","decimal"],["value","text"],["matInput","","name","length","formControlName","length","placeholder","Length",3,"keydown.space"],["class","error-msg",4,"ngIf"],["fxFlex","100",1,"mt-1"],["mat-raised-button","","color","primary",3,"disabled"],["fxFlex",""],["mat-button","","color","warn","type","button",3,"click"],[1,"error-msg"]],template:function(t,e){1&t&&(r.bc(0,"h1",0),r.Pc(1),r.ac(),r.bc(2,"form",1),r.jc("ngSubmit",(function(t){return e.submit()})),r.bc(3,"div",2),r.bc(4,"div",3),r.bc(5,"mat-form-field",4),r.Wb(6,"input",5),r.ac(),r.ac(),r.bc(7,"div",3),r.bc(8,"mat-form-field",4),r.bc(9,"mat-label"),r.Pc(10,"Format"),r.ac(),r.bc(11,"mat-select",6),r.jc("valueChange",(function(t){return e.format=t})),r.bc(12,"mat-option",7),r.Pc(13,"Integer"),r.ac(),r.bc(14,"mat-option",8),r.Pc(15,"Decimal"),r.ac(),r.bc(16,"mat-option",9),r.Pc(17,"Text"),r.ac(),r.ac(),r.ac(),r.ac(),r.bc(18,"div",3),r.bc(19,"mat-form-field",4),r.bc(20,"input",10),r.jc("keydown.space",(function(t){return t.preventDefault()})),r.ac(),r.ac(),r.ac(),r.Nc(21,ce,2,0,"p",11),r.bc(22,"div",12),r.bc(23,"button",13),r.Pc(24),r.oc(25,"translate"),r.ac(),r.Wb(26,"span",14),r.bc(27,"button",15),r.jc("click",(function(t){return e.dialogRef.close(!1)})),r.Pc(28,"Cancel"),r.ac(),r.ac(),r.ac(),r.ac()),2&t&&(r.Gb(1),r.Qc(e.data.title),r.Gb(1),r.sc("formGroup",e.itemForm),r.Gb(9),r.sc("value",e.format),r.Gb(10),r.sc("ngIf",e.validationErrors),r.Gb(2),r.sc("disabled",e.itemForm.invalid),r.Gb(1),r.Qc(r.pc(25,6,"SAVE")))},directives:[c.g,n.u,n.o,n.h,s.b,l.b,n.b,n.n,n.f,s.e,z.a,E.p,a.l,u.b],pipes:[p.c],styles:[""]}),re);function le(t,e){if(1&t&&r.Pc(0),2&t){var i=e.row;r.Rc(" ",null==i?null:i.name," ")}}function ue(t,e){if(1&t&&r.Pc(0),2&t){var i=e.row;r.Rc(" ",null==i?null:i.format," ")}}function pe(t,e){if(1&t&&r.Pc(0),2&t){var i=e.row;r.Rc(" ",null==i?null:i.length," ")}}function he(t,e){if(1&t){var i=r.cc();r.bc(0,"mat-slide-toggle",10),r.jc("change",(function(t){r.Gc(i);var a=e.row;return r.nc().statusChange(a,t)})),r.ac()}if(2&t){var a=e.row;r.sc("checked","active"===(null==a?null:a.status))}}function de(t,e){if(1&t){var i=r.cc();r.bc(0,"button",11),r.jc("click",(function(t){r.Gc(i);var a=e.row;return r.nc().openPopUp(a)})),r.bc(1,"mat-icon"),r.Pc(2,"edit"),r.ac(),r.ac(),r.bc(3,"button",12),r.jc("click",(function(t){r.Gc(i);var a=e.row;return r.nc().deleteItem(a)})),r.bc(4,"mat-icon"),r.Pc(5,"delete"),r.ac(),r.ac()}}var me,fe=((me=function(){function t(e,i,a,o,n){_classCallCheck(this,t),this.dialog=e,this.snack=i,this.loader=a,this.confirmService=o,this.productApiService=n,this.attributes=[],this.subscripition=new k.a}return _createClass(t,[{key:"ngOnInit",value:function(){this.getAllProducts()}},{key:"getAllProducts",value:function(){var t=this;this.subscripition.add(this.productApiService.getAllAttribute().subscribe((function(e){t.attributes=_toConsumableArray(e.result),t.loader.close()}),(function(e){t.loader.close()})))}},{key:"closeLoader",value:function(){this.loader.close()}},{key:"openPopUp",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;this.dialog.open(se,{width:"520px",disableClose:!0,data:{title:i?"Add Attribute":"Update Attribute",payload:e}}).afterClosed().subscribe((function(a){a&&(t.loader.open(),t.subscripition.add(i?t.productApiService.addAttribute(a).subscribe((function(e){t.loader.close(),"success"===e.status&&(t.getAttributes(e.result._id,"add"),t.snack.open("Attribute Added!","OK",{duration:4e3}))}),(function(e){t.loader.close()})):t.productApiService.updateAttribute(e._id,a).subscribe((function(e){t.loader.close(),"success"===e.status&&(t.getAttributes(e.result._id,"update"),t.snack.open("Attribute Updated!","OK",{duration:4e3}))}),(function(e){t.loader.close()}))))}))}},{key:"getAttributes",value:function(t,e){var i=this;this.subscripition.add(this.productApiService.getAttribute(t).subscribe((function(t){"add"===e?(i.attributes.push(t.result),i.attributes=_toConsumableArray(i.attributes)):i.attributes.forEach((function(e,a){e._id===t.result._id&&(i.attributes[a]=t.result,i.attributes=_toConsumableArray(i.attributes))}))}),(function(t){i.loader.close()})))}},{key:"deleteItem",value:function(t){var e=this;this.subscripition.add(this.confirmService.confirm({message:"Delete ".concat(t.name,"?")}).subscribe((function(i){i&&(e.loader.open(),e.attributes.forEach((function(i,a){i._id===t._id&&e.attributes.splice(a,1)})),e.attributes=_toConsumableArray(e.attributes),e.productApiService.deleteAttribute(t._id).subscribe((function(t){e.loader.close(),"success"===t.status&&e.snack.open("Product deleted!","OK",{duration:4e3})})))}),(function(t){e.loader.close()})))}},{key:"statusChange",value:function(t,e){var i=this;this.loader.open(),this.subscripition.add(this.productApiService.updateAttribute(t._id,{status:e.checked?"active":"inactive"}).subscribe((function(e){i.loader.close(),"success"===e.status&&(i.getAttributes(t._id,"update"),i.snack.open("Status Updated!","OK",{duration:4e3}))}),(function(t){i.loader.close()})))}},{key:"ngOnDestroy",value:function(){this.subscripition.unsubscribe()}}]),t}()).\u0275fac=function(t){return new(t||me)(r.Vb(c.b),r.Vb(w.a),r.Vb(g.a),r.Vb(C.a),r.Vb(lt))},me.\u0275cmp=r.Pb({type:me,selectors:[["app-attributes"]],decls:18,vars:18,consts:[[1,"m-333"],["mat-raised-button","","color","primary",1,"mb-05",3,"click"],[1,"p-0"],[1,"material","ml-0","mr-0",3,"rows","columnMode","headerHeight","footerHeight","scrollbarH","limit","rowHeight"],["name","Name",3,"flexGrow"],["ngx-datatable-cell-template",""],["name","Format",3,"flexGrow"],["name","Length",3,"flexGrow"],["name","Active",3,"flexGrow"],["name","Actions",3,"flexGrow"],[3,"checked","change"],["mat-icon-button","","mat-sm-button","","color","primary",1,"mr-1",3,"click"],["mat-icon-button","","mat-sm-button","","color","warn",3,"click"]],template:function(t,e){1&t&&(r.bc(0,"div",0),r.bc(1,"button",1),r.jc("click",(function(t){return e.openPopUp({},!0)})),r.Pc(2),r.oc(3,"translate"),r.oc(4,"translate"),r.ac(),r.ac(),r.bc(5,"mat-card",2),r.bc(6,"mat-card-content",2),r.bc(7,"ngx-datatable",3),r.bc(8,"ngx-datatable-column",4),r.Nc(9,le,1,1,"ng-template",5),r.ac(),r.bc(10,"ngx-datatable-column",6),r.Nc(11,ue,1,1,"ng-template",5),r.ac(),r.bc(12,"ngx-datatable-column",7),r.Nc(13,pe,1,1,"ng-template",5),r.ac(),r.bc(14,"ngx-datatable-column",8),r.Nc(15,he,1,1,"ng-template",5),r.ac(),r.bc(16,"ngx-datatable-column",9),r.Nc(17,de,6,0,"ng-template",5),r.ac(),r.ac(),r.ac(),r.ac()),2&t&&(r.Gb(2),r.Sc(" ",r.pc(3,14,"ADD")," ",r.pc(4,16,"Attribute")," "),r.Gb(5),r.sc("rows",e.attributes)("columnMode","force")("headerHeight",50)("footerHeight",50)("scrollbarH",!0)("limit",10)("rowHeight",50),r.Gb(1),r.sc("flexGrow",1),r.Gb(2),r.sc("flexGrow",1),r.Gb(2),r.sc("flexGrow",1),r.Gb(2),r.sc("flexGrow",1),r.Gb(2),r.sc("flexGrow",1))},directives:[u.b,S.a,S.b,A.d,A.b,A.a,_.a,P.a],pipes:[p.c],styles:[""]}),me),ge=i("jtHE"),be=i("XNiG"),ve=i("1G5W"),ye=i("FtGj"),xe=i("2Vo4"),Ce=i("itXk"),ke=i("pLZG"),we=i("eIep"),Se=i("JX91"),Ae=i("lJxs"),_e=i("3E0/"),Pe=i("IzEk"),Ie=i("vkgz"),Me=i("bSwM"),Oe=i("Xa2L"),Ge=i("Qu3c"),Re=i("vxfF"),Fe=i("u47x"),ze=["searchSelectInput"],Ee=["innerSelectSearch"];function Ue(t,e){if(1&t){var i=r.cc();r.bc(0,"mat-checkbox",9),r.jc("change",(function(t){return r.Gc(i),r.nc()._emitSelectAllBooleanToParent(t.checked)})),r.ac()}if(2&t){var a=r.nc();r.sc("color",null==a.matFormField?null:a.matFormField.color)("checked",a.toggleAllCheckboxChecked)("indeterminate",a.toggleAllCheckboxIndeterminate)("matTooltip",a.toggleAllCheckboxTooltipMessage)("matTooltipPosition",a.toogleAllCheckboxTooltipPosition)}}function De(t,e){1&t&&r.Wb(0,"mat-spinner",10)}function Te(t,e){1&t&&r.qc(0,1,["*ngIf","clearIcon; else defaultIcon"])}function Ve(t,e){1&t&&(r.bc(0,"mat-icon"),r.Pc(1,"close"),r.ac())}function je(t,e){if(1&t){var i=r.cc();r.bc(0,"button",11),r.jc("click",(function(t){return r.Gc(i),r.nc()._reset(!0)})),r.Nc(1,Te,1,0,void 0,12),r.Nc(2,Ve,2,0,"ng-template",null,13,r.Oc),r.ac()}if(2&t){var a=r.Cc(3),o=r.nc();r.Gb(1),r.sc("ngIf",o.clearIcon)("ngIfElse",a)}}function We(t,e){if(1&t&&(r.bc(0,"div",14),r.Pc(1),r.ac()),2&t){var i=r.nc();r.Gb(1),r.Rc(" ",i.noEntriesFoundLabel,"\n")}}var He,Ne,Le,Be,Qe=[[["",8,"mat-select-search-custom-header-content"]],[["","ngxMatSelectSearchClear",""]]],Ke=function(t,e){return{"mat-select-search-inner-multiple":t,"mat-select-search-inner-toggle-all":e}},qe=[".mat-select-search-custom-header-content","[ngxMatSelectSearchClear]"],Xe=((He=function t(){_classCallCheck(this,t)}).\u0275fac=function(t){return new(t||He)},He.\u0275dir=r.Qb({type:He,selectors:[["","ngxMatSelectSearchClear",""]]}),He),Ye=((Be=Ne=function(){function t(e,i,a){var o=this,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4?arguments[4]:void 0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;_classCallCheck(this,t),this.matSelect=e,this.changeDetectorRef=i,this._viewportRuler=a,this.matOption=c,this.liveAnnouncer=s,this.matFormField=l,this.placeholderLabel="Suche",this.type="text",this.noEntriesFoundLabel="Keine Optionen gefunden",this.indexAndLengthScreenReaderText=" of ",this.clearSearchInput=!0,this.searching=!1,this.disableInitialFocus=!1,this.enableClearOnEscapePressed=!1,this.preventHomeEndKeyPropagation=!1,this.disableScrollToActiveOnOptionsChanged=!1,this.ariaLabel="dropdown search",this.showToggleAllCheckbox=!1,this.toggleAllCheckboxChecked=!1,this.toggleAllCheckboxIndeterminate=!1,this.toggleAllCheckboxTooltipMessage="",this.toogleAllCheckboxTooltipPosition="below",this.toggleAll=new r.o,this.onTouched=function(t){},this._options$=new xe.a(null),this._formControl=new n.d(""),this._showNoEntriesFound$=Object(Ce.a)([this._formControl.valueChanges,this._options$.pipe(Object(ke.a)((function(t){return!!t})),Object(we.a)((function(t){return t.changes.pipe(Object(Se.a)(t.toArray()),Object(Ae.a)((function(t){return t.length})))})))]).pipe(Object(Ae.a)((function(t){var e=_slicedToArray(t,2),i=e[0],a=e[1];return o.noEntriesFoundLabel&&i&&a===o.getOptionsLengthOffset()}))),this._onDestroy=new be.a}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this,e="mat-select-search-panel";this.matSelect.panelClass?Array.isArray(this.matSelect.panelClass)?this.matSelect.panelClass.push(e):"string"==typeof this.matSelect.panelClass?this.matSelect.panelClass=[this.matSelect.panelClass,e]:"object"==typeof this.matSelect.panelClass&&(this.matSelect.panelClass[e]=!0):this.matSelect.panelClass=e,this.matOption?(this.matOption.disabled=!0,this.matOption._getHostElement().classList.add("contains-mat-select-search")):console.error("<ngx-mat-select-search> must be placed inside a <mat-option> element"),this.matSelect.openedChange.pipe(Object(_e.a)(1),Object(ve.a)(this._onDestroy)).subscribe((function(e){e?(t.updateInputWidth(),t.disableInitialFocus||t._focus()):t.clearSearchInput&&t._reset()})),this.matSelect.openedChange.pipe(Object(Pe.a)(1)).pipe(Object(ve.a)(this._onDestroy)).subscribe((function(){t.matSelect._keyManager?t.matSelect._keyManager.change.pipe(Object(ve.a)(t._onDestroy)).subscribe((function(){return t.adjustScrollTopToFitActiveOptionIntoView()})):console.log("_keyManager was not initialized."),t._options=t.matSelect.options;var e=t._options.toArray()[t.getOptionsLengthOffset()];t._options.changes.pipe(Object(ve.a)(t._onDestroy)).subscribe((function(){var i=t._options.toArray(),a=t.matSelect._keyManager;a&&t.matSelect.panelOpen&&setTimeout((function(){var o=i[t.getOptionsLengthOffset()];!t.matSelect.compareWith(e,o)&&a.setFirstItemActive(),e=o,setTimeout((function(){t.updateInputWidth()})),t.disableScrollToActiveOnOptionsChanged||t.adjustScrollTopToFitActiveOptionIntoView()}),1)}))})),this._showNoEntriesFound$.pipe(Object(ve.a)(this._onDestroy)).subscribe((function(e){t.matOption&&(e?t.matOption._getHostElement().classList.add("mat-select-search-no-entries-found"):t.matOption._getHostElement().classList.remove("mat-select-search-no-entries-found"))})),this._viewportRuler.change().pipe(Object(ve.a)(this._onDestroy)).subscribe((function(){t.matSelect.panelOpen&&t.updateInputWidth()})),this.initMultipleHandling(),this._options$.pipe(Object(ke.a)((function(t){return!!t})),Object(we.a)((function(t){return t.changes})),Object(ve.a)(this._onDestroy)).subscribe((function(){t.changeDetectorRef.markForCheck()}))}},{key:"_emitSelectAllBooleanToParent",value:function(t){this.toggleAll.emit(t)}},{key:"ngOnDestroy",value:function(){this._onDestroy.next(),this._onDestroy.complete()}},{key:"_isToggleAllCheckboxVisible",value:function(){return this.matSelect.multiple&&this.showToggleAllCheckbox}},{key:"_handleKeydown",value:function(t){(t.key&&1===t.key.length||t.keyCode>=ye.a&&t.keyCode<=ye.q||t.keyCode>=ye.r&&t.keyCode<=ye.j||t.keyCode===ye.n||this.preventHomeEndKeyPropagation&&(t.keyCode===ye.h||t.keyCode===ye.e))&&t.stopPropagation(),!0===this.enableClearOnEscapePressed&&t.keyCode===ye.g&&this.value&&(this._reset(!0),t.stopPropagation())}},{key:"_handleKeyup",value:function(t){if(t.keyCode===ye.p||t.keyCode===ye.d){var e=this.matSelect._getAriaActiveDescendant(),i=this._options.toArray().findIndex((function(t){return t.id===e}));if(-1!==i){var a=this._options.toArray()[i];this.liveAnnouncer.announce(a.viewValue+" "+this.getAriaIndex(i)+this.indexAndLengthScreenReaderText+this.getAriaLength())}}}},{key:"getAriaIndex",value:function(t){return 0===this.getOptionsLengthOffset()?t+1:t}},{key:"getAriaLength",value:function(){return this._options.toArray().length-this.getOptionsLengthOffset()}},{key:"writeValue",value:function(t){this._lastExternalInputValue=t,this._formControl.setValue(t),this.changeDetectorRef.markForCheck()}},{key:"onBlur",value:function(){this.onTouched()}},{key:"registerOnChange",value:function(t){var e=this;this._formControl.valueChanges.pipe(Object(ke.a)((function(t){return t!==e._lastExternalInputValue})),Object(Ie.a)((function(){return e._lastExternalInputValue=void 0})),Object(ve.a)(this._onDestroy)).subscribe(t)}},{key:"registerOnTouched",value:function(t){this.onTouched=t}},{key:"_focus",value:function(){if(this.searchSelectInput&&this.matSelect.panel){var t=this.matSelect.panel.nativeElement,e=t.scrollTop;this.searchSelectInput.nativeElement.focus(),t.scrollTop=e}}},{key:"_reset",value:function(t){this._formControl.setValue(""),t&&this._focus()}},{key:"initMultipleHandling",value:function(){var t=this;this.matSelect.valueChange.pipe(Object(ve.a)(this._onDestroy)).subscribe((function(e){if(t.matSelect.multiple){var i=!1;if(t._formControl.value&&t._formControl.value.length&&t.previousSelectedValues&&Array.isArray(t.previousSelectedValues)){e&&Array.isArray(e)||(e=[]);var a=t.matSelect.options.map((function(t){return t.value}));t.previousSelectedValues.forEach((function(o){e.some((function(e){return t.matSelect.compareWith(e,o)}))||a.some((function(e){return t.matSelect.compareWith(e,o)}))||(e.push(o),i=!0)}))}i&&t.matSelect._onChange(e),t.previousSelectedValues=e}})),this.initMultiSelectedValues()}},{key:"adjustScrollTopToFitActiveOptionIntoView",value:function(){if(this.matSelect.panel&&this.matSelect.options.length>0){var t=this.getMatOptionHeight(),e=this.matSelect._keyManager.activeItemIndex||0,i=Object(E.x)(e,this.matSelect.options,this.matSelect.optionGroups),a=(this.matOption?-1:0)+i+e,o=this.matSelect.panel.nativeElement.scrollTop,n=this.innerSelectSearch.nativeElement.offsetHeight,c=Math.floor((z.c-n)/t),r=Math.round((o+n)/t)-1;r>=a?this.matSelect.panel.nativeElement.scrollTop=a*t:r+c<=a&&(this.matSelect.panel.nativeElement.scrollTop=(a+1)*t-(z.c-n))}}},{key:"updateInputWidth",value:function(){if(this.innerSelectSearch&&this.innerSelectSearch.nativeElement){for(var t,e=this.innerSelectSearch.nativeElement;e=e.parentElement;)if(e.classList.contains("mat-select-panel")){t=e;break}t&&(this.innerSelectSearch.nativeElement.style.width=t.clientWidth+"px")}}},{key:"getMatOptionHeight",value:function(){return this.matSelect.options.length>0?this.matSelect.options.first._getHostElement().getBoundingClientRect().height:0}},{key:"initMultiSelectedValues",value:function(){var t=this;Object(Ce.a)([this._formControl.valueChanges.pipe(Object(Se.a)(this._formControl.value)),this._options$.pipe(Object(ke.a)((function(t){return!!t})))]).pipe(Object(ve.a)(this._onDestroy)).subscribe((function(e){var i=_slicedToArray(e,2),a=i[0],o=i[1];t.matSelect.multiple&&!a&&(t.previousSelectedValues=o.filter((function(t){return t.selected})).map((function(t){return t.value})))}))}},{key:"getOptionsLengthOffset",value:function(){return this.matOption?1:0}},{key:"isInsideMatOption",get:function(){return!!this.matOption}},{key:"value",get:function(){return this._formControl.value}},{key:"_options",set:function(t){this._options$.next(t)},get:function(){return this._options$.getValue()}}]),t}()).\u0275fac=function(t){return new(t||Be)(r.Vb(z.a),r.Vb(r.h),r.Vb(Re.d),r.Vb(E.p,8),r.Vb(Fe.k),r.Vb(s.b,8))},Be.\u0275cmp=r.Pb({type:Be,selectors:[["ngx-mat-select-search"]],contentQueries:function(t,e,i){var a;1&t&&r.Nb(i,Xe,!0),2&t&&r.Bc(a=r.kc())&&(e.clearIcon=a.first)},viewQuery:function(t,e){var i;1&t&&(r.Lc(ze,!0,r.l),r.Lc(Ee,!0,r.l)),2&t&&(r.Bc(i=r.kc())&&(e.searchSelectInput=i.first),r.Bc(i=r.kc())&&(e.innerSelectSearch=i.first))},hostVars:2,hostBindings:function(t,e){2&t&&r.Lb("mat-select-search-inside-mat-option",e.isInsideMatOption)},inputs:{placeholderLabel:"placeholderLabel",type:"type",noEntriesFoundLabel:"noEntriesFoundLabel",indexAndLengthScreenReaderText:"indexAndLengthScreenReaderText",clearSearchInput:"clearSearchInput",searching:"searching",disableInitialFocus:"disableInitialFocus",enableClearOnEscapePressed:"enableClearOnEscapePressed",preventHomeEndKeyPropagation:"preventHomeEndKeyPropagation",disableScrollToActiveOnOptionsChanged:"disableScrollToActiveOnOptionsChanged",ariaLabel:"ariaLabel",showToggleAllCheckbox:"showToggleAllCheckbox",toggleAllCheckboxChecked:"toggleAllCheckboxChecked",toggleAllCheckboxIndeterminate:"toggleAllCheckboxIndeterminate",toggleAllCheckboxTooltipMessage:"toggleAllCheckboxTooltipMessage",toogleAllCheckboxTooltipPosition:"toogleAllCheckboxTooltipPosition"},outputs:{toggleAll:"toggleAll"},features:[r.Fb([{provide:n.l,useExisting:Object(r.X)((function(){return Ne})),multi:!0}])],ngContentSelectors:qe,decls:11,vars:14,consts:[["matInput","",1,"mat-select-search-input","mat-select-search-hidden"],[1,"mat-select-search-inner","mat-typography","mat-datepicker-content","mat-tab-header",3,"ngClass"],["innerSelectSearch",""],["class","mat-select-search-toggle-all-checkbox","matTooltipClass","ngx-mat-select-search-toggle-all-tooltip",3,"color","checked","indeterminate","matTooltip","matTooltipPosition","change",4,"ngIf"],["matInput","","autocomplete","off",1,"mat-select-search-input",3,"type","formControl","placeholder","keydown","keyup","blur"],["searchSelectInput",""],["class","mat-select-search-spinner","diameter","16",4,"ngIf"],["mat-button","","mat-icon-button","","aria-label","Clear","class","mat-select-search-clear",3,"click",4,"ngIf"],["class","mat-select-search-no-entries-found",4,"ngIf"],["matTooltipClass","ngx-mat-select-search-toggle-all-tooltip",1,"mat-select-search-toggle-all-checkbox",3,"color","checked","indeterminate","matTooltip","matTooltipPosition","change"],["diameter","16",1,"mat-select-search-spinner"],["mat-button","","mat-icon-button","","aria-label","Clear",1,"mat-select-search-clear",3,"click"],[4,"ngIf","ngIfElse"],["defaultIcon",""],[1,"mat-select-search-no-entries-found"]],template:function(t,e){1&t&&(r.rc(Qe),r.Wb(0,"input",0),r.bc(1,"div",1,2),r.Nc(3,Ue,1,5,"mat-checkbox",3),r.bc(4,"input",4,5),r.jc("keydown",(function(t){return e._handleKeydown(t)}))("keyup",(function(t){return e._handleKeyup(t)}))("blur",(function(t){return e.onBlur()})),r.ac(),r.Nc(6,De,1,0,"mat-spinner",6),r.Nc(7,je,4,2,"button",7),r.qc(8),r.ac(),r.Nc(9,We,2,1,"div",8),r.oc(10,"async")),2&t&&(r.Gb(1),r.sc("ngClass",r.yc(11,Ke,e.matSelect.multiple,e._isToggleAllCheckboxVisible())),r.Gb(2),r.sc("ngIf",e._isToggleAllCheckboxVisible()),r.Gb(1),r.sc("type",e.type)("formControl",e._formControl)("placeholder",e.placeholderLabel),r.Hb("aria-label",e.ariaLabel),r.Gb(2),r.sc("ngIf",e.searching),r.Gb(1),r.sc("ngIf",e.value&&!e.searching),r.Gb(2),r.sc("ngIf",r.pc(10,9,e._showNoEntriesFound$)))},directives:[l.b,a.j,a.l,n.b,n.n,n.e,Me.a,Ge.a,Oe.b,u.b,P.a],pipes:[a.b],styles:[".mat-select-search-hidden[_ngcontent-%COMP%]{visibility:hidden}.mat-select-search-inner[_ngcontent-%COMP%]{position:absolute;top:0;width:100%;border-bottom-width:1px;border-bottom-style:solid;z-index:100;font-size:inherit;box-shadow:none;border-radius:4px 4px 0 0;-webkit-transform:translate3d(0,0,0)}.mat-select-search-inner.mat-select-search-inner-multiple[_ngcontent-%COMP%]{width:100%}.mat-select-search-inner.mat-select-search-inner-multiple.mat-select-search-inner-toggle-all[_ngcontent-%COMP%]{display:flex;align-items:center}.mat-select-search-inner[_ngcontent-%COMP%]   .mat-input-element[_ngcontent-%COMP%]{flex-basis:auto}.mat-select-search-inner[_ngcontent-%COMP%]   .mat-input-element[_ngcontent-%COMP%]:-ms-input-placeholder{-ms-user-select:text}  .mat-select-search-panel{transform:none!important;overflow-x:hidden}.mat-select-search-input[_ngcontent-%COMP%]{padding:16px 36px 16px 16px;box-sizing:border-box}.mat-select-search-no-entries-found[_ngcontent-%COMP%]{padding:16px}.mat-select-search-clear[_ngcontent-%COMP%]{position:absolute;right:4px;top:5px}.mat-select-search-spinner[_ngcontent-%COMP%]{position:absolute;right:16px;top:calc(50% - 8px)}.mat-select-search-inside-mat-option[_nghost-%COMP%]   .mat-select-search-input[_ngcontent-%COMP%]{padding-top:0;padding-bottom:0;height:3em;line-height:3em}.mat-select-search-inside-mat-option[_nghost-%COMP%]   .mat-select-search-clear[_ngcontent-%COMP%]{top:3px}  .mat-option[aria-disabled=true].contains-mat-select-search{position:static;padding:0}  .mat-option[aria-disabled=true].contains-mat-select-search .mat-icon{margin-right:0}  .mat-option[aria-disabled=true].contains-mat-select-search .mat-option-pseudo-checkbox{display:none}  .mat-option[aria-disabled=true].contains-mat-select-search.mat-select-search-no-entries-found{height:6em}.mat-select-search-toggle-all-checkbox[_ngcontent-%COMP%]{padding-left:16px;padding-bottom:2px}"],changeDetection:0}),Be),$e=((Le=function t(){_classCallCheck(this,t)}).\u0275mod=r.Tb({type:Le}),Le.\u0275inj=r.Sb({factory:function(t){return new(t||Le)},imports:[[a.c,n.r,u.c,Me.b,P.b,l.c,Oe.a,Ge.b]]}),Le),Je=["singleSelect"];function Ze(t,e){if(1&t&&(r.bc(0,"mat-option",17),r.Pc(1),r.ac()),2&t){var i=e.$implicit;r.sc("value",i),r.Gb(1),r.Qc(i.name)}}function ti(t,e){if(1&t&&(r.bc(0,"mat-option",17),r.Pc(1),r.ac()),2&t){var i=e.$implicit;r.sc("value",i._id),r.Gb(1),r.Qc(i.name)}}function ei(t,e){1&t&&(r.bc(0,"p",18),r.Pc(1,"*Please fill all the fields"),r.ac())}var ii,ai=((ii=function(){function t(e,i,a,o,c){_classCallCheck(this,t),this.data=e,this.dialogRef=i,this.fb=a,this.loader=o,this.productApiService=c,this.subscripition=new k.a,this.products=[],this.attributes=[],this.productFilterCtrl=new n.d,this.bankCtrl=new n.d,this.filteredProducts=new ge.a(1),this._onDestroy=new be.a}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.loader.open(),this.getProducts(),this.getAttributes(),this.buildItemForm(this.data.payload),this.productFilterCtrl.valueChanges.pipe(Object(ve.a)(this._onDestroy)).subscribe((function(){t.filterBanks()}))}},{key:"ngAfterViewInit",value:function(){this.setInitialValue()}},{key:"setInitialValue",value:function(){var t=this;this.filteredProducts.subscribe((function(e){t.singleSelect.compareWith=function(t,e){return t._id===e._id}}))}},{key:"filterBanks",value:function(){if(this.products){var t=this.productFilterCtrl.value;t?(t=t.toLowerCase(),this.filteredProducts.next(this.products.filter((function(e){return e.name.toLowerCase().indexOf(t)>-1})))):this.filteredProducts.next(this.products.slice())}}},{key:"getProducts",value:function(){var t=this;this.subscripition.add(this.productApiService.getAllProducts().subscribe((function(e){t.products=e.result,t.filteredProducts.next(t.products.slice()),t.loader.close()}),(function(e){t.loader.close()})))}},{key:"getAttributes",value:function(){var t=this;this.subscripition.add(this.productApiService.getAllAttribute().subscribe((function(e){t.attributes=e.result,t.loader.close()}),(function(e){t.loader.close()})))}},{key:"buildItemForm",value:function(t){var e,i,a,o;this.itemForm=this.fb.group({item:[(null===(i=null===(e=t)||void 0===e?void 0:e.item)||void 0===i?void 0:i._id)||null,n.t.required],attribute:[(null===(o=null===(a=t)||void 0===a?void 0:a.attribute)||void 0===o?void 0:o._id)||null,n.t.required],value:[t.value||null,n.t.required],factor:[t.factor||null,n.t.required]})}},{key:"submit",value:function(){this.itemForm.value.value=this.itemForm.value.value.trim(),this.itemForm.value.factor=this.itemForm.value.factor.trim(),this.itemForm.value.value.length>0&&this.itemForm.value.factor.length>0?this.dialogRef.close(this.itemForm.value):this.validationErrors=!0}},{key:"ngOnDestroy",value:function(){this.loader.close(),this.subscripition.unsubscribe(),this._onDestroy.next(),this._onDestroy.complete()}}]),t}()).\u0275fac=function(t){return new(t||ii)(r.Vb(c.a),r.Vb(c.f),r.Vb(n.c),r.Vb(g.a),r.Vb(lt))},ii.\u0275cmp=r.Pb({type:ii,selectors:[["app-specifications-popup"]],viewQuery:function(t,e){var i;1&t&&r.Lc(Je,!0),2&t&&r.Bc(i=r.kc())&&(e.singleSelect=i.first)},decls:30,vars:12,consts:[["matDialogTitle",""],[3,"formGroup","ngSubmit"],["fxLayout","row wrap","fxLayout.lt-sm","column"],["fxFlex","50",1,"pr-1"],[1,"full-width","p-b-10"],["placeholder","Select Product","name","item","formControlName","item",1,"full-width","state-box"],["singleSelect",""],["placeholderLabel","Find bank...","placeholderLabel","Find product","noEntriesFoundLabel","'No matching product found'",3,"formControl"],["ngDefaultControl","",3,"value",4,"ngFor","ngForOf"],["placeholder","Select Attribute","name","attributes","formControlName","attribute",1,"full-width","state-box"],["matInput","","name","value","formControlName","value","placeholder","Value"],["matInput","","name","factor","formControlName","factor","placeholder","Factor"],["class","error-msg",4,"ngIf"],["fxFlex","100",1,"mt-1"],["mat-raised-button","","color","primary",3,"disabled"],["fxFlex",""],["mat-button","","color","warn","type","button",3,"click"],["ngDefaultControl","",3,"value"],[1,"error-msg"]],template:function(t,e){1&t&&(r.bc(0,"h1",0),r.Pc(1),r.ac(),r.bc(2,"form",1),r.jc("ngSubmit",(function(t){return e.submit()})),r.bc(3,"div",2),r.bc(4,"div",3),r.bc(5,"mat-form-field",4),r.bc(6,"mat-select",5,6),r.bc(8,"mat-option"),r.Wb(9,"ngx-mat-select-search",7),r.ac(),r.Nc(10,Ze,2,2,"mat-option",8),r.oc(11,"async"),r.ac(),r.ac(),r.ac(),r.bc(12,"div",3),r.bc(13,"mat-form-field",4),r.bc(14,"mat-select",9),r.Nc(15,ti,2,2,"mat-option",8),r.ac(),r.ac(),r.ac(),r.bc(16,"div",3),r.bc(17,"mat-form-field",4),r.Wb(18,"input",10),r.ac(),r.ac(),r.bc(19,"div",3),r.bc(20,"mat-form-field",4),r.Wb(21,"input",11),r.ac(),r.ac(),r.Nc(22,ei,2,0,"p",12),r.bc(23,"div",13),r.bc(24,"button",14),r.Pc(25),r.oc(26,"translate"),r.ac(),r.Wb(27,"span",15),r.bc(28,"button",16),r.jc("click",(function(t){return e.dialogRef.close(!1)})),r.Pc(29,"Cancel"),r.ac(),r.ac(),r.ac(),r.ac()),2&t&&(r.Gb(1),r.Qc(e.data.title),r.Gb(1),r.sc("formGroup",e.itemForm),r.Gb(7),r.sc("formControl",e.productFilterCtrl),r.Gb(1),r.sc("ngForOf",r.pc(11,8,e.filteredProducts)),r.Gb(5),r.sc("ngForOf",e.attributes),r.Gb(7),r.sc("ngIf",e.validationErrors),r.Gb(2),r.sc("disabled",e.itemForm.invalid),r.Gb(1),r.Qc(r.pc(26,10,"SAVE")))},directives:[c.g,n.u,n.o,n.h,s.b,z.a,n.n,n.f,E.p,Ye,n.e,a.k,l.b,n.b,a.l,u.b],pipes:[a.b,p.c],styles:[".error-msg[_ngcontent-%COMP%]{color:red}"]}),ii);function oi(t,e){if(1&t&&r.Pc(0),2&t){var i=e.row;r.Rc(" ",null==i?null:null==i.item?null:i.item.name," ")}}function ni(t,e){if(1&t&&r.Pc(0),2&t){var i=e.row;r.Rc(" ",null==i?null:null==i.attribute?null:i.attribute.name," ")}}function ci(t,e){if(1&t&&r.Pc(0),2&t){var i=e.row;r.Rc(" ",null==i?null:i.value," ")}}function ri(t,e){if(1&t&&r.Pc(0),2&t){var i=e.row;r.Rc(" ",null==i?null:i.factor," ")}}function si(t,e){if(1&t){var i=r.cc();r.bc(0,"mat-slide-toggle",11),r.jc("change",(function(t){r.Gc(i);var a=e.row;return r.nc().statusChange(a,t)})),r.ac()}if(2&t){var a=e.row;r.sc("checked","active"===(null==a?null:a.status))}}function li(t,e){if(1&t){var i=r.cc();r.bc(0,"button",12),r.jc("click",(function(t){r.Gc(i);var a=e.row;return r.nc().openPopUp(a)})),r.bc(1,"mat-icon"),r.Pc(2,"edit"),r.ac(),r.ac(),r.bc(3,"button",13),r.jc("click",(function(t){r.Gc(i);var a=e.row;return r.nc().deleteItem(a)})),r.bc(4,"mat-icon"),r.Pc(5,"delete"),r.ac(),r.ac()}}var ui,pi,hi,di=((ui=function(){function t(e,i,a,o,n){_classCallCheck(this,t),this.dialog=e,this.snack=i,this.loader=a,this.confirmService=o,this.productApiService=n,this.specifications=[],this.subscripition=new k.a}return _createClass(t,[{key:"ngOnInit",value:function(){this.getAllSpecifications()}},{key:"getAllSpecifications",value:function(){var t=this;this.subscripition.add(this.productApiService.getAllSpecification().subscribe((function(e){t.specifications=_toConsumableArray(e.result),t.loader.close()}),(function(e){t.loader.close()})))}},{key:"closeLoader",value:function(){this.loader.close()}},{key:"openPopUp",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;this.dialog.open(ai,{width:"520px",disableClose:!0,data:{title:i?"Add Specification":"Update Specification",payload:e}}).afterClosed().subscribe((function(a){a&&(t.loader.open(),t.subscripition.add(i?t.productApiService.addSpecification(a).subscribe((function(e){t.loader.close(),"success"===e.status&&(t.getSpecifications(e.result._id,"add"),t.snack.open("Specification Added!","OK",{duration:4e3}))}),(function(e){t.loader.close()})):t.productApiService.updateSpecification(e._id,a).subscribe((function(e){t.loader.close(),"success"===e.status&&(t.getSpecifications(e.result._id,"update"),t.snack.open("Specification Updated!","OK",{duration:4e3}))}),(function(e){t.loader.close()}))))}))}},{key:"getSpecifications",value:function(t,e){var i=this;this.subscripition.add(this.productApiService.getSpecification(t).subscribe((function(t){"add"===e?(i.specifications.push(t.result),i.specifications=_toConsumableArray(i.specifications)):i.specifications.forEach((function(e,a){e._id===t.result._id&&(i.specifications[a]=t.result,i.specifications=_toConsumableArray(i.specifications))}))}),(function(t){i.loader.close()})))}},{key:"deleteItem",value:function(t){var e=this;this.subscripition.add(this.confirmService.confirm({message:"Delete ".concat(t.name,"?")}).subscribe((function(i){i&&(e.loader.open(),e.specifications.forEach((function(i,a){i._id===t._id&&e.specifications.splice(a,1)})),e.specifications=_toConsumableArray(e.specifications),e.productApiService.deleteSpecification(t._id).subscribe((function(t){e.loader.close(),"success"===t.status&&e.snack.open("Specification deleted!","OK",{duration:4e3})})))}),(function(t){e.loader.close()})))}},{key:"statusChange",value:function(t,e){var i=this;this.loader.open(),this.subscripition.add(this.productApiService.updateSpecification(t._id,{status:e.checked?"active":"inactive"}).subscribe((function(e){i.loader.close(),"success"===e.status&&(i.getSpecifications(t._id,"update"),i.snack.open("Status Updated!","OK",{duration:4e3}))}),(function(t){i.loader.close()})))}},{key:"ngOnDestroy",value:function(){this.subscripition.unsubscribe()}}]),t}()).\u0275fac=function(t){return new(t||ui)(r.Vb(c.b),r.Vb(w.a),r.Vb(g.a),r.Vb(C.a),r.Vb(lt))},ui.\u0275cmp=r.Pb({type:ui,selectors:[["app-specifications"]],decls:20,vars:19,consts:[[1,"m-333"],["mat-raised-button","","color","primary",1,"mb-05",3,"click"],[1,"p-0"],[1,"material","ml-0","mr-0",3,"rows","columnMode","headerHeight","footerHeight","scrollbarH","limit","rowHeight"],["name","Product",3,"flexGrow"],["ngx-datatable-cell-template",""],["name","Attribute",3,"flexGrow"],["name","Value",3,"flexGrow"],["name","Factor",3,"flexGrow"],["name","Active",3,"flexGrow"],["name","Actions",3,"flexGrow"],[3,"checked","change"],["mat-icon-button","","mat-sm-button","","color","primary",1,"mr-1",3,"click"],["mat-icon-button","","mat-sm-button","","color","warn",3,"click"]],template:function(t,e){1&t&&(r.bc(0,"div",0),r.bc(1,"button",1),r.jc("click",(function(t){return e.openPopUp({},!0)})),r.Pc(2),r.oc(3,"translate"),r.oc(4,"translate"),r.ac(),r.ac(),r.bc(5,"mat-card",2),r.bc(6,"mat-card-content",2),r.bc(7,"ngx-datatable",3),r.bc(8,"ngx-datatable-column",4),r.Nc(9,oi,1,1,"ng-template",5),r.ac(),r.bc(10,"ngx-datatable-column",6),r.Nc(11,ni,1,1,"ng-template",5),r.ac(),r.bc(12,"ngx-datatable-column",7),r.Nc(13,ci,1,1,"ng-template",5),r.ac(),r.bc(14,"ngx-datatable-column",8),r.Nc(15,ri,1,1,"ng-template",5),r.ac(),r.bc(16,"ngx-datatable-column",9),r.Nc(17,si,1,1,"ng-template",5),r.ac(),r.bc(18,"ngx-datatable-column",10),r.Nc(19,li,6,0,"ng-template",5),r.ac(),r.ac(),r.ac(),r.ac()),2&t&&(r.Gb(2),r.Sc(" ",r.pc(3,15,"ADD")," ",r.pc(4,17,"Specification")," "),r.Gb(5),r.sc("rows",e.specifications)("columnMode","force")("headerHeight",50)("footerHeight",50)("scrollbarH",!0)("limit",10)("rowHeight",50),r.Gb(1),r.sc("flexGrow",1),r.Gb(2),r.sc("flexGrow",1),r.Gb(2),r.sc("flexGrow",1),r.Gb(2),r.sc("flexGrow",1),r.Gb(2),r.sc("flexGrow",1),r.Gb(2),r.sc("flexGrow",1))},directives:[u.b,S.a,S.b,A.d,A.b,A.a,_.a,P.a],pipes:[p.c],styles:[""]}),ui),mi=[{path:"",component:st,children:[{path:"",redirectTo:"state"},{path:"state",component:F},{path:"district",component:Q},{path:"region",component:ct},{path:"category",component:jt},{path:"products",component:(pi=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"ngOnInit",value:function(){}}]),t}(),pi.\u0275fac=function(t){return new(t||pi)},pi.\u0275cmp=r.Pb({type:pi,selectors:[["app-products"]],decls:7,vars:0,consts:[["headerPosition","primary","color","primary","backgroundColor",""],["label","Item"],["label","Attribute"],["label","Specification"]],template:function(t,e){1&t&&(r.bc(0,"mat-tab-group",0),r.bc(1,"mat-tab",1),r.Wb(2,"app-product"),r.ac(),r.bc(3,"mat-tab",2),r.Wb(4,"app-attributes"),r.ac(),r.bc(5,"mat-tab",3),r.Wb(6,"app-specifications"),r.ac(),r.ac())},directives:[Wt.b,Wt.a,ne,fe,di],styles:[""]}),pi)},{path:"**",redirectTo:""}]}],fi=((hi=function t(){_classCallCheck(this,t)}).\u0275mod=r.Tb({type:hi}),hi.\u0275inj=r.Sb({factory:function(t){return new(t||hi)},imports:[[o.k.forChild(mi)],o.k]}),hi),gi=i("zMWy"),bi=i("PCNd");i.d(e,"DashboardModule",(function(){return yi}));var vi,yi=((vi=function t(){_classCallCheck(this,t)}).\u0275mod=r.Tb({type:vi}),vi.\u0275inj=r.Sb({factory:function(t){return new(t||vi)},imports:[[a.c,fi,bi.a,gi.a,p.b,A.e,xt,$e]]}),vi)}}]);